import{j as u}from"./jsx-runtime-u17CrQMm.js";import{r as h}from"./iframe-DrRAcTtF.js";import{r as _e}from"./index-Ci4OHB6e.js";function Te({controlledValue:t,defaultValue:r}){const[a,o]=h.useState(t??r);return h.useEffect(()=>{t!==void 0&&o(t)},[t]),{internalValue:a,setInternalValue:o}}function Re({options:t,query:r,userTyped:a,filterOption:o,searchBy:i="both",allowCreate:g=!1,multiple:b=!1,filterSelected:_=!1,internalValue:y}){const w=Array.isArray(y)?y:[],n=h.useMemo(()=>{if(!r||!a){const f=t;return b&&_?f.filter(I=>!w.includes(I.value)):f}const p=r.trim().toLowerCase();if(o)return t.filter(f=>o(p,f));if(i==="label")return t.filter(f=>f.label.toLowerCase().includes(p));if(i==="value")return t.filter(f=>f.value.toLowerCase().includes(p));const d=t.filter(f=>f.label.toLowerCase().includes(p)),R=t.filter(f=>!f.label.toLowerCase().includes(p)&&f.value.toLowerCase().includes(p)),q=[...d,...R];return b&&_?q.filter(f=>!w.includes(f.value)):q},[t,r,a,o,i,b,_,y]),c=h.useMemo(()=>{const p=n,d=r.trim();return g&&d&&p.length===0?[{label:d,value:d,__isNew:!0}]:p},[n,g,r]);return{filteredOptions:n,displayOptions:c}}function xe({displayOptions:t,open:r,setOpen:a,handleSelectByValue:o,isDisabled:i=!1,onBackspace:g,onChar:b}){const[_,y]=h.useState(null),w=h.useCallback(n=>{if(!i){if(r&&n.key==="Backspace"&&(n.preventDefault(),g)){g(n);return}if(r&&n.key.length===1&&!n.ctrlKey&&!n.metaKey&&!n.altKey&&b){n.preventDefault(),b(n);return}if(n.key==="ArrowDown"){if(n.preventDefault(),!r){a(!0);return}y(c=>{const p=t,d=c===null?-1:c;for(let R=d+1;R<p.length;R++)if(!p[R].disabled)return R;return c})}else if(n.key==="ArrowUp"){if(n.preventDefault(),!r){a(!0);return}y(c=>{const p=t,d=c===null?p.length:c;for(let R=d-1;R>=0;R--)if(!p[R].disabled)return R;return c})}else if(n.key==="Enter"||n.key===" "){if(n.preventDefault(),!r)a(!0);else if(_!==null){const c=t[_];c&&!c.disabled&&o(c.value)}}else if(n.key==="Escape")a(!1);else if(n.key==="Home"){n.preventDefault();const c=t.findIndex(p=>!p.disabled);y(c>=0?c:0)}else if(n.key==="End"){n.preventDefault();const c=t.map(p=>p.disabled?-1:1).lastIndexOf(1);y(c>=0?c:t.length-1)}}},[t,r,a,o,_,i,g,b]);return{highlighted:_,setHighlighted:y,onKeyDown:w}}function Ee(t=700,r){const a=h.useRef(null),o=r??h.useRef(!1);function i(){a.current&&(window.clearTimeout(a.current),a.current=null)}function g(y){i(),a.current=window.setTimeout(()=>y(""),t)}function b({query:y,setQuery:w,options:n,setHighlighted:c}){const d=o.current?y.slice(0,-1):"";o.current=!0,w(d),g(w);const q=(d?n.filter(f=>f.label.toLowerCase().includes(d.trim().toLowerCase())||f.value.toLowerCase().includes(d.trim().toLowerCase())):n).findIndex(f=>!f.disabled);c(q>=0?q:0)}function _({key:y,query:w,setQuery:n,options:c,multiple:p,searchable:d,setHighlighted:R}){const q=!o.current&&!p&&d?y:w+y;o.current=!0,n(q),g(n);const f=q.trim().toLowerCase(),U=(f?c.filter(x=>x.label.toLowerCase().includes(f)||x.value.toLowerCase().includes(f)):c).findIndex(x=>!x.disabled);R(U>=0?U:0)}return{handleBackspace:b,handleChar:_,clear:i,userTypedRef:o}}const J={open:!1,query:"",highlighted:null,inputFocused:!1};function qe(t,r){switch(r.type){case"SET_OPEN":return{...t,open:r.payload};case"TOGGLE_OPEN":return{...t,open:!t.open};case"SET_QUERY":return{...t,query:r.payload};case"CLEAR_QUERY":return{...t,query:""};case"SET_HIGHLIGHTED":return{...t,highlighted:r.payload};case"SET_INPUT_FOCUSED":return{...t,inputFocused:r.payload};case"RESET":return{...J};default:return t}}function Ne(){const[t,r]=h.useReducer(qe,J);return{state:t,setOpen:a=>r({type:"SET_OPEN",payload:a}),toggleOpen:()=>r({type:"TOGGLE_OPEN"}),setQuery:a=>r({type:"SET_QUERY",payload:a}),clearQuery:()=>r({type:"CLEAR_QUERY"}),setHighlighted:a=>{r(typeof a=="function"?{type:"SET_HIGHLIGHTED",payload:a(t.highlighted)}:{type:"SET_HIGHLIGHTED",payload:a})},setInputFocused:a=>r({type:"SET_INPUT_FOCUSED",payload:a}),reset:()=>r({type:"RESET"})}}const Z=({id:t,option:r,index:a,highlighted:o,isSelected:i,onMouseEnter:g,onMouseDown:b,renderHighlightedLabel:_})=>{const y=r.__isNew===!0,w=r.disabled;return u.jsxs("li",{id:t,role:"option","aria-disabled":w,"aria-selected":i,className:`beaver-select__option ${i?"beaver-select__option--selected":""} ${w?"beaver-select__option--disabled":""} ${o===a?"beaver-select__option--highlighted":""} ${y?"beaver-select__option--new":""}`,"data-disabled":w?"true":void 0,tabIndex:-1,onMouseEnter:()=>{w||g(a)},onMouseDown:n=>{w||(n.preventDefault(),n.stopPropagation(),b(n,r.value,w))},onPointerDown:n=>{r.disabled||(n.preventDefault(),n.stopPropagation(),b(n,r.value,w))},onTouchStart:n=>{r.disabled||(n.preventDefault(),n.stopPropagation(),b(n,r.value,w))},onClick:n=>n.stopPropagation(),children:[u.jsx("span",{className:"beaver-select__opt-label",children:y?u.jsx("span",{className:"beaver-select__create-label",children:`使用 "${r.label}"`}):_(r.label)}),i&&u.jsx("span",{className:"beaver-select__opt-checkmark","aria-hidden":!0,children:u.jsx("svg",{viewBox:"0 0 24 24",width:"16",height:"16",fill:"none",stroke:"currentColor",strokeWidth:"2.5",strokeLinecap:"round",strokeLinejoin:"round",children:u.jsx("polyline",{points:"20 6 9 17 4 12"})})})]},r.value)};Z.__docgenInfo={description:"",methods:[],displayName:"OptionItem",props:{id:{required:!0,tsType:{name:"string"},description:""},option:{required:!0,tsType:{name:"intersection",raw:"SelectOption & { __isNew?: true }",elements:[{name:"signature",type:"object",raw:`{
  label: string;
  value: string;
  disabled?: boolean;
}`,signature:{properties:[{key:"label",value:{name:"string",required:!0}},{key:"value",value:{name:"string",required:!0}},{key:"disabled",value:{name:"boolean",required:!1}}]}},{name:"signature",type:"object",raw:"{ __isNew?: true }",signature:{properties:[{key:"__isNew",value:{name:"literal",value:"true",required:!1}}]}}]},description:""},index:{required:!0,tsType:{name:"number"},description:""},highlighted:{required:!0,tsType:{name:"union",raw:"number | null",elements:[{name:"number"},{name:"null"}]},description:""},isSelected:{required:!0,tsType:{name:"boolean"},description:""},onMouseEnter:{required:!0,tsType:{name:"signature",type:"function",raw:"(index: number) => void",signature:{arguments:[{type:{name:"number"},name:"index"}],return:{name:"void"}}},description:""},onMouseDown:{required:!0,tsType:{name:"signature",type:"function",raw:"(e: React.MouseEvent, value: string, disabled?: boolean) => void",signature:{arguments:[{type:{name:"ReactMouseEvent",raw:"React.MouseEvent"},name:"e"},{type:{name:"string"},name:"value"},{type:{name:"boolean"},name:"disabled"}],return:{name:"void"}}},description:""},renderHighlightedLabel:{required:!0,tsType:{name:"signature",type:"function",raw:"(label: string) => React.ReactNode",signature:{arguments:[{type:{name:"string"},name:"label"}],return:{name:"ReactReactNode",raw:"React.ReactNode"}}},description:""}}};const ee=({menuOptions:t,highlighted:r,internalValue:a,onHighlight:o,onSelectByValue:i,renderHighlightedLabel:g,noDataLabel:b,listRef:_,menuStyle:y,menuClassName:w})=>u.jsxs("ul",{role:"listbox",className:`beaver-select__menu ${w??""}`,style:y,ref:_,tabIndex:-1,"aria-activedescendant":r!==null?`beaver-select-opt-${r}`:void 0,onPointerDownCapture:n=>{const c=n.composedPath?n.composedPath():n.composedPath?.();c&&Array.isArray(c)&&c.some(d=>d&&d.getAttribute&&d.getAttribute("data-disabled")==="true")&&(n.preventDefault(),n.stopPropagation())},onTouchStartCapture:n=>{const c=n.composedPath?n.composedPath():n.composedPath?.();c&&Array.isArray(c)&&c.some(d=>d&&d.getAttribute&&d.getAttribute("data-disabled")==="true")&&(n.preventDefault(),n.stopPropagation())},children:[t.map((n,c)=>{const d=n.__isNew===!0?`__create-${n.value}`:n.value,R=Array.isArray(a)?a.includes(n.value):n.value===a;return u.jsx(Z,{id:`beaver-select-opt-${c}`,option:n,index:c,highlighted:r,isSelected:R,onMouseEnter:q=>o(q),onMouseDown:(q,f,I)=>{I||i(n.value)},renderHighlightedLabel:g},d)}),t.length===0&&u.jsx("li",{className:"beaver-select__option beaver-select__no-data","aria-disabled":!0,children:u.jsx("span",{className:"beaver-select__opt-label",children:b??"暂无数据"})},"__no_data_or_match")]});ee.__docgenInfo={description:"",methods:[],displayName:"OptionList",props:{menuOptions:{required:!0,tsType:{name:"Array",elements:[{name:"unknown"}],raw:"(SelectOption & { __isNew?: true })[]"},description:""},highlighted:{required:!0,tsType:{name:"union",raw:"number | null",elements:[{name:"number"},{name:"null"}]},description:""},internalValue:{required:!1,tsType:{name:"union",raw:"string | string[] | undefined",elements:[{name:"string"},{name:"Array",elements:[{name:"string"}],raw:"string[]"},{name:"undefined"}]},description:""},onHighlight:{required:!0,tsType:{name:"signature",type:"function",raw:"(i: number) => void",signature:{arguments:[{type:{name:"number"},name:"i"}],return:{name:"void"}}},description:""},onSelectByValue:{required:!0,tsType:{name:"signature",type:"function",raw:"(value: string) => void",signature:{arguments:[{type:{name:"string"},name:"value"}],return:{name:"void"}}},description:""},renderHighlightedLabel:{required:!0,tsType:{name:"signature",type:"function",raw:"(label: string) => React.ReactNode",signature:{arguments:[{type:{name:"string"},name:"label"}],return:{name:"ReactReactNode",raw:"React.ReactNode"}}},description:""},noDataLabel:{required:!1,tsType:{name:"string"},description:"空数据时显示的提示文字，外部负责根据上下文（searchable/userTyped/query/options.length）计算"},listRef:{required:!1,tsType:{name:"ReactRef",raw:"React.Ref<HTMLUListElement>",elements:[{name:"HTMLUListElement"}]},description:"可选的 ul ref，供父组件（Select）聚焦或滚动使用"},menuStyle:{required:!1,tsType:{name:"ReactCSSProperties",raw:"React.CSSProperties"},description:"可选的样式，用于父组件传入动态宽度（例如与触发器宽度保持一致）"},menuClassName:{required:!1,tsType:{name:"string"},description:"可选的额外 className，供父组件（Select）标记菜单上下文（例如 size）"}}};const te=({values:t,options:r,onRemove:a})=>u.jsx("div",{className:"beaver-select__tags",children:t.map(o=>u.jsxs("span",{className:"beaver-select__tag",onClick:i=>i.stopPropagation(),children:[u.jsx("span",{className:"beaver-select__tag-label",children:r.find(i=>i.value===o)?.label??o}),u.jsx("button",{type:"button","aria-label":`remove ${o}`,className:"beaver-select__tag-remove",onClick:i=>{i.stopPropagation(),a(o,i)},children:"×"})]},o))});te.__docgenInfo={description:"",methods:[],displayName:"Tags",props:{values:{required:!0,tsType:{name:"Array",elements:[{name:"string"}],raw:"string[]"},description:""},options:{required:!0,tsType:{name:"Array",elements:[{name:"signature",type:"object",raw:`{
  label: string;
  value: string;
  disabled?: boolean;
}`,signature:{properties:[{key:"label",value:{name:"string",required:!0}},{key:"value",value:{name:"string",required:!0}},{key:"disabled",value:{name:"boolean",required:!1}}]}}],raw:"SelectOption[]"},description:""},onRemove:{required:!0,tsType:{name:"signature",type:"function",raw:"(value: string, e?: React.MouseEvent) => void",signature:{arguments:[{type:{name:"string"},name:"value"},{type:{name:"ReactMouseEvent",raw:"React.MouseEvent"},name:"e"}],return:{name:"void"}}},description:""}}};const ne=({multiple:t,query:r,onChangeEvent:a,searchRef:o,onKeyDown:i,onFocus:g,onBlur:b,placeholder:_,selectedValues:y=[],options:w=[],removeTag:n,onMouseDown:c,onClick:p})=>t?u.jsxs("div",{className:"beaver-select__tags-input",onMouseDown:c,onClick:p,children:[u.jsx(te,{values:y,options:w,onRemove:n??(()=>{})}),u.jsx("input",{ref:o,className:"beaver-select__input",value:r,onChange:d=>a?a(d):void 0,onFocus:g,onBlur:b,onKeyDown:i,placeholder:y.length===0&&!r?_:""})]}):u.jsx("input",{ref:o,className:"beaver-select__input",value:r,onChange:d=>a?a(d):void 0,onFocus:g,onBlur:b,onKeyDown:i,onMouseDown:d=>d.stopPropagation(),onClick:d=>d.stopPropagation(),placeholder:_});ne.__docgenInfo={description:"",methods:[],displayName:"SearchInput",props:{multiple:{required:!1,tsType:{name:"boolean"},description:""},query:{required:!0,tsType:{name:"string"},description:""},onChangeEvent:{required:!1,tsType:{name:"signature",type:"function",raw:"(e: React.ChangeEvent<HTMLInputElement>) => void",signature:{arguments:[{type:{name:"ReactChangeEvent",raw:"React.ChangeEvent<HTMLInputElement>",elements:[{name:"HTMLInputElement"}]},name:"e"}],return:{name:"void"}}},description:"接收原生 input 的 ChangeEvent。父组件可通过事件对象读取 value 并决定如何处理（例如替换行为）"},searchRef:{required:!1,tsType:{name:"ReactRefObject",raw:"React.RefObject<HTMLInputElement | null>",elements:[{name:"union",raw:"HTMLInputElement | null",elements:[{name:"HTMLInputElement"},{name:"null"}]}]},description:"允许传入可能为 null 的 ref（Select 中常用 RefObject<HTMLInputElement | null>）"},onKeyDown:{required:!1,tsType:{name:"signature",type:"function",raw:"(e: React.KeyboardEvent<HTMLInputElement>) => void",signature:{arguments:[{type:{name:"ReactKeyboardEvent",raw:"React.KeyboardEvent<HTMLInputElement>",elements:[{name:"HTMLInputElement"}]},name:"e"}],return:{name:"void"}}},description:""},onFocus:{required:!1,tsType:{name:"signature",type:"function",raw:"() => void",signature:{arguments:[],return:{name:"void"}}},description:""},onBlur:{required:!1,tsType:{name:"signature",type:"function",raw:"(e: React.FocusEvent<HTMLInputElement>) => void",signature:{arguments:[{type:{name:"ReactFocusEvent",raw:"React.FocusEvent<HTMLInputElement>",elements:[{name:"HTMLInputElement"}]},name:"e"}],return:{name:"void"}}},description:""},placeholder:{required:!1,tsType:{name:"string"},description:""},selectedValues:{required:!1,tsType:{name:"Array",elements:[{name:"string"}],raw:"string[]"},description:"",defaultValue:{value:"[]",computed:!1}},options:{required:!1,tsType:{name:"Array",elements:[{name:"signature",type:"object",raw:`{
  label: string;
  value: string;
  disabled?: boolean;
}`,signature:{properties:[{key:"label",value:{name:"string",required:!0}},{key:"value",value:{name:"string",required:!0}},{key:"disabled",value:{name:"boolean",required:!1}}]}}],raw:"SelectOption[]"},description:"",defaultValue:{value:"[]",computed:!1}},removeTag:{required:!1,tsType:{name:"signature",type:"function",raw:"(value: string, e?: React.MouseEvent) => void",signature:{arguments:[{type:{name:"string"},name:"value"},{type:{name:"ReactMouseEvent",raw:"React.MouseEvent"},name:"e"}],return:{name:"void"}}},description:""},onMouseDown:{required:!1,tsType:{name:"signature",type:"function",raw:"(e: React.MouseEvent) => void",signature:{arguments:[{type:{name:"ReactMouseEvent",raw:"React.MouseEvent"},name:"e"}],return:{name:"void"}}},description:""},onClick:{required:!1,tsType:{name:"signature",type:"function",raw:"(e: React.MouseEvent) => void",signature:{arguments:[{type:{name:"ReactMouseEvent",raw:"React.MouseEvent"},name:"e"}],return:{name:"void"}}},description:""}}};const re=({selectedValues:t,options:r,onRemove:a})=>u.jsx("div",{className:"beaver-select__tags",children:t.map(o=>u.jsxs("span",{className:"beaver-select__tag",onClick:i=>i.stopPropagation(),children:[u.jsx("span",{className:"beaver-select__tag-label",children:r.find(i=>i.value===o)?.label??o}),u.jsx("button",{type:"button","aria-label":`remove ${o}`,className:"beaver-select__tag-remove",onClick:i=>a(o,i),children:"×"})]},o))});re.__docgenInfo={description:"多选标签显示组件",methods:[],displayName:"SelectTags",props:{selectedValues:{required:!0,tsType:{name:"Array",elements:[{name:"string"}],raw:"string[]"},description:"已选值数组"},options:{required:!0,tsType:{name:"Array",elements:[{name:"signature",type:"object",raw:`{
  label: string;
  value: string;
  disabled?: boolean;
}`,signature:{properties:[{key:"label",value:{name:"string",required:!0}},{key:"value",value:{name:"string",required:!0}},{key:"disabled",value:{name:"boolean",required:!1}}]}}],raw:"SelectOption[]"},description:"选项列表"},onRemove:{required:!0,tsType:{name:"signature",type:"function",raw:"(value: string, e?: React.MouseEvent) => void",signature:{arguments:[{type:{name:"string"},name:"value"},{type:{name:"ReactMouseEvent",raw:"React.MouseEvent"},name:"e"}],return:{name:"void"}}},description:"移除标签回调"}}};const ae=({loading:t,loadingIcon:r,icon:a})=>u.jsx("div",{className:"beaver-select__icons",children:t?r?u.jsx("span",{className:"beaver-select__loading-icon",children:r}):u.jsx("span",{className:"beaver-select__spinner","aria-hidden":!0}):a?u.jsx("span",{className:"beaver-select__icon",children:a}):u.jsx("span",{className:"beaver-select__arrow","aria-hidden":!0,children:u.jsx("svg",{className:"beaver-select__arrow-svg",width:"14",height:"14",viewBox:"0 0 24 24",fill:"none",xmlns:"http://www.w3.org/2000/svg","aria-hidden":!0,children:u.jsx("path",{d:"M6 9l6 6 6-6",stroke:"currentColor",strokeWidth:2,strokeLinecap:"round",strokeLinejoin:"round"})})})});ae.__docgenInfo={description:`Select 组件的图标区（右侧）
支持：loading 状态、自定义图标`,methods:[],displayName:"SelectIcons",props:{loading:{required:!0,tsType:{name:"boolean"},description:"是否加载中"},loadingIcon:{required:!1,tsType:{name:"ReactReactNode",raw:"React.ReactNode"},description:"自定义 loading 图标"},icon:{required:!1,tsType:{name:"ReactReactNode",raw:"React.ReactNode"},description:"自定义图标"}}};function se(t,r){const a=r.trim();if(!a)return t;const i=t.toLowerCase().indexOf(a.toLowerCase());if(i===-1)return t;const g=t.slice(0,i),b=t.slice(i,i+a.length),_=t.slice(i+a.length);return u.jsxs(u.Fragment,{children:[g,u.jsx("span",{className:"beaver-select__match",children:b}),_]})}function Ie(t){return t===void 0?{}:{width:typeof t=="number"?`${t}px`:t}}function je(t,r,a,o){return["beaver-select-wrapper",`beaver-select--${t}`,r?"beaver-select--disabled":"",a?"beaver-select--open":"",o||""].filter(Boolean).join(" ")}function Le(t,r,a,o){return t?"暂无数据":r&&a&&o.trim()?"无匹配项":"暂无数据"}se.__docgenInfo={description:"高亮渲染 label 中匹配的子串",methods:[],displayName:"renderHighlightedLabel"};const ke=({options:t=[],placeholder:r="请选择",value:a,defaultValue:o,onChange:i,searchable:g=!1,allowCreate:b=!1,filterOption:_,searchBy:y="both",disabled:w=!1,loading:n=!1,icon:c,loadingIcon:p,className:d,size:R="medium",menuClassName:q,name:f,width:I,style:U,multiple:x=!1,filterSelected:Q=!1,...ie})=>{const{state:le,setOpen:A,setQuery:j,setHighlighted:L,setInputFocused:F}=Ne(),{open:T,query:N,highlighted:z}=le,{internalValue:v,setInternalValue:M}=Te({controlledValue:a,defaultValue:o}),k=h.useRef(null),ue=h.useRef(null),B=h.useRef(null),P=h.useRef(!1),S=h.useRef(!1),Y=h.useRef(null),{handleBackspace:oe,handleChar:ce}=Ee(700,S),[C,K]=h.useState(null);h.useEffect(()=>{const e=k.current;if(e)return T&&C!==null&&I===void 0&&(e.style.setProperty("width",`${C}px`),e.style.setProperty("box-sizing","border-box")),!T&&I===void 0&&(e.style.removeProperty("width"),e.style.removeProperty("box-sizing")),()=>{I===void 0&&(e.style.removeProperty("width"),e.style.removeProperty("box-sizing"))}},[T,C,I]),h.useEffect(()=>{if(!T||I!==void 0)return;const e=k.current;if(!e)return;const s=new ResizeObserver(()=>{const l=e.getBoundingClientRect().width;K(l)});return s.observe(e),()=>{s.disconnect()}},[T,I]);const[,de]=h.useState(0);h.useEffect(()=>{if(!T)return;const e=k.current;if(!e)return;const s=()=>{de(m=>m+1)},l=new MutationObserver(s);return l.observe(e,{childList:!0,subtree:!0,characterData:!0,attributes:!0}),()=>{l.disconnect()}},[T]),h.useEffect(()=>{function e(s){k.current&&(k.current.contains(s.target)||A(!1))}return document.addEventListener("mousedown",e),()=>{document.removeEventListener("mousedown",e)}},[T]),h.useEffect(()=>{if(!T)return;function e(){const s=k.current;s&&K(s.getBoundingClientRect().width)}return window.addEventListener("resize",e),()=>window.removeEventListener("resize",e)},[T]);const{displayOptions:H}=Re({options:t,query:N,userTyped:S.current,filterOption:_,searchBy:y,allowCreate:b,multiple:x,filterSelected:Q,internalValue:v});h.useEffect(()=>{if(!T){if(P.current){P.current=!1,L(null);return}if(b&&N.trim()){const e=N.trim(),s=t.find(l=>l.value===e||l.label===e);s&&!s.disabled?(a===void 0&&M(s.value),i?.(s.value)):(a===void 0&&M(e),i?.(e))}j(""),L(null)}},[T]),h.useEffect(()=>()=>{Y.current&&window.clearTimeout(Y.current)},[]);const W=Array.isArray(v)?t.find(e=>e.value===v[0]):t.find(e=>e.value===v),G=Array.isArray(v)?v:[],O=w||n;function me(){if(!O)if(T)A(!1);else{const e=k.current;if(e){const s=e.getBoundingClientRect().width;K(s)}A(!0),setTimeout(()=>{const s=k.current;s&&s.getBoundingClientRect().width},0)}}function D(e){const s=t.find(m=>m.value===e);if(s&&s.disabled)return;if(x===!0){const m=Array.isArray(v)?[...v]:[],E=m.indexOf(e);E>=0?m.splice(E,1):m.push(e),a===void 0&&M(m),i?.(m),j(""),P.current=!0,Q&&A(!1);return}a===void 0&&M(e),i?.(e),g&&(S.current=!1),j(""),P.current=!0,A(!1)}const{onKeyDown:pe}=xe({displayOptions:H,open:T,setOpen:A,handleSelectByValue:D,isDisabled:O,onBackspace:e=>{e.preventDefault(),oe({query:N,setQuery:j,options:t,setHighlighted:L})},onChar:e=>{e.preventDefault(),ce({key:e.key,query:N,setQuery:j,options:t,multiple:x,searchable:g,setHighlighted:L})}});h.useEffect(()=>{if(T&&z===null){const e=H,s=e.findIndex(m=>Array.isArray(v)?v.includes(m.value):m.value===v),l=e.findIndex(m=>!m.disabled);L(s>=0?s:l>=0?l:0)}T&&g&&setTimeout(()=>B.current?.focus(),0)},[T]);const fe=H;function X(e,s){s?.stopPropagation();const l=Array.isArray(v)?[...v]:[],m=l.indexOf(e);m>=0&&l.splice(m,1),a===void 0&&M(l),i?.(l)}const ve=(e,s)=>{X(e,s)},ge=e=>{S.current=!0,j(e.target.value),L(0)},ye=e=>{const s=e.target.value;if(!S.current&&!x&&g){let l=s.replace(N,"");l===""&&(l=s),S.current=!0,j(l),L(0);return}S.current=!0,j(s),L(0)},be=()=>{F(!0),!S.current&&g&&!x&&N&&setTimeout(()=>B.current?.select(),0)},he=e=>{if(e.stopPropagation(),P.current){P.current=!1,F(!1);return}const s=N.trim();if(b&&s){const l=t.find(m=>m.value===s||m.label===s);l&&!l.disabled?x?D(l.value):(a===void 0&&M(l.value),i?.(l.value)):x?D(s):(a===void 0&&M(s),i?.(s))}j(""),F(!1)},we=e=>{if(e.stopPropagation(),e.key==="ArrowDown")e.preventDefault(),L(s=>{const l=H,m=s===null?-1:s;for(let E=m+1;E<l.length;E++)if(!l[E].disabled)return E;return s});else if(e.key==="ArrowUp")e.preventDefault(),L(s=>{const l=H,m=s===null?l.length:s;for(let E=m-1;E>=0;E--)if(!l[E].disabled)return E;return s});else if(e.key==="Enter"){e.preventDefault();const s=N.trim();if(b&&s&&!t.find($=>$.value===s||$.label===s)){D(s),j("");return}const m=H[z??0];m&&!m.disabled&&D(m.value)}else e.key==="Escape"&&A(!1)};return u.jsxs("div",{className:je(R,O,T,d),ref:k,"aria-disabled":O,style:{...U,...Ie(I)},children:[u.jsxs("div",{role:"button",className:"beaver-select__control","aria-haspopup":"listbox","aria-expanded":T,onClick:me,onKeyDown:pe,tabIndex:O?-1:0,...ie,children:[u.jsx("div",{className:"beaver-select__display",children:g&&T?u.jsx(ne,{multiple:x,query:N,onChangeEvent:x?ge:ye,searchRef:B,onKeyDown:we,onFocus:be,onBlur:he,placeholder:N?"":v&&!Array.isArray(v)?t.find(e=>e.value===v)?.label??String(v):r,selectedValues:G,options:t,removeTag:ve,onMouseDown:e=>e.stopPropagation(),onClick:e=>e.stopPropagation()}):Array.isArray(v)?G.length===0?u.jsx("span",{className:"beaver-select__value beaver-select__placeholder",children:r}):u.jsx(re,{selectedValues:G,options:t,onRemove:X}):u.jsx("span",{className:`beaver-select__value ${v??W?"":"beaver-select__placeholder"}`,children:v?t.find(e=>e.value===v)?.label??v:W?W.label:r})}),u.jsx(ae,{loading:n,loadingIcon:p,icon:c})]}),T&&(()=>{const e=k.current;let s;if(e){const l=e.getBoundingClientRect(),m=l.left+window.scrollX,E=l.bottom+window.scrollY,$=Math.max(window.innerWidth-l.left-16,0),V=C?Math.min(C,$):void 0;s={position:"absolute",left:`${m}px`,top:`${E}px`,width:V?`${V}px`:"auto",minWidth:C&&V===void 0?`${C}px`:void 0,maxWidth:`${$}px`,boxSizing:"border-box",zIndex:"var(--beaver-select-z-index, 5000)"}}return _e.createPortal(u.jsx(ee,{menuOptions:fe,highlighted:z,internalValue:v,onHighlight:l=>L(l),onSelectByValue:l=>D(l),renderHighlightedLabel:l=>se(l,N),noDataLabel:Le(t.length===0,g,S.current,N),listRef:ue,menuStyle:s,menuClassName:q}),document.body)})(),x===!0?u.jsx("select",{name:f,multiple:!0,value:Array.isArray(v)?v:[],onChange:e=>{const s=Array.from(e.target.selectedOptions,l=>l.value);a===void 0&&M(s),i?.(s)},style:{display:"none"},"aria-hidden":!0,children:t.map(e=>u.jsx("option",{value:e.value,children:e.label},e.value))}):u.jsx("select",{name:f,value:(Array.isArray(v)?v[0]:v)??"",onChange:e=>{D(e.target.value)},style:{display:"none"},"aria-hidden":!0})]})};ke.__docgenInfo={description:"",methods:[],displayName:"Select",props:{options:{required:!1,tsType:{name:"Array",elements:[{name:"signature",type:"object",raw:`{
  label: string;
  value: string;
  disabled?: boolean;
}`,signature:{properties:[{key:"label",value:{name:"string",required:!0}},{key:"value",value:{name:"string",required:!0}},{key:"disabled",value:{name:"boolean",required:!1}}]}}],raw:"SelectOption[]"},description:"下拉选项列表",defaultValue:{value:"[]",computed:!1}},placeholder:{required:!1,tsType:{name:"string"},description:"占位符",defaultValue:{value:"'请选择'",computed:!1}},value:{required:!1,tsType:{name:"union",raw:"string | string[]",elements:[{name:"string"},{name:"Array",elements:[{name:"string"}],raw:"string[]"}]},description:"单选时为 string，复选时为 string[]"},defaultValue:{required:!1,tsType:{name:"union",raw:"string | string[]",elements:[{name:"string"},{name:"Array",elements:[{name:"string"}],raw:"string[]"}]},description:"默认值"},onChange:{required:!1,tsType:{name:"signature",type:"function",raw:"(value: string | string[]) => void",signature:{arguments:[{type:{name:"union",raw:"string | string[]",elements:[{name:"string"},{name:"Array",elements:[{name:"string"}],raw:"string[]"}]},name:"value"}],return:{name:"void"}}},description:"事件回调，参数为选中的值"},multiple:{required:!1,tsType:{name:"boolean"},description:"是否支持多选",defaultValue:{value:"false",computed:!1}},searchable:{required:!1,tsType:{name:"boolean"},description:"是否在下拉中显示搜索框",defaultValue:{value:"false",computed:!1}},allowCreate:{required:!1,tsType:{name:"boolean"},description:"是否允许在没有匹配项时创建自定义输入项（默认 false）",defaultValue:{value:"false",computed:!1}},filterOption:{required:!1,tsType:{name:"signature",type:"function",raw:"(input: string, option: SelectOption) => boolean",signature:{arguments:[{type:{name:"string"},name:"input"},{type:{name:"signature",type:"object",raw:`{
  label: string;
  value: string;
  disabled?: boolean;
}`,signature:{properties:[{key:"label",value:{name:"string",required:!0}},{key:"value",value:{name:"string",required:!0}},{key:"disabled",value:{name:"boolean",required:!1}}]}},name:"option"}],return:{name:"boolean"}}},description:"定制过滤函数：如果提供，将优先使用"},searchBy:{required:!1,tsType:{name:"union",raw:"'label' | 'value' | 'both'",elements:[{name:"literal",value:"'label'"},{name:"literal",value:"'value'"},{name:"literal",value:"'both'"}]},description:"搜索策略：'label' 只按 label 搜索，'value' 只按 value，'both' 按 label 与 value 搜索但优先 label 匹配",defaultValue:{value:"'both'",computed:!1}},filterSelected:{required:!1,tsType:{name:"boolean"},description:"仅在 `multiple` 为 true 时生效：在下拉中隐藏已选项，并在每次多选后关闭下拉。",defaultValue:{value:"false",computed:!1}},disabled:{required:!1,tsType:{name:"boolean"},description:"是否禁用",defaultValue:{value:"false",computed:!1}},loading:{required:!1,tsType:{name:"boolean"},description:"是否加载中",defaultValue:{value:"false",computed:!1}},icon:{required:!1,tsType:{name:"ReactReactNode",raw:"React.ReactNode"},description:"自定义箭头/后缀图标（传入 ReactNode）"},loadingIcon:{required:!1,tsType:{name:"ReactReactNode",raw:"React.ReactNode"},description:"自定义 loading 图标（传入 ReactNode），优先于默认 spinner"},width:{required:!1,tsType:{name:"union",raw:"number | string",elements:[{name:"number"},{name:"string"}]},description:"直接设置组件宽度，支持 number(像素) 或 字符串(如 '50%','200px')"},size:{required:!1,tsType:{name:"union",raw:"'small' | 'medium' | 'large'",elements:[{name:"literal",value:"'small'"},{name:"literal",value:"'medium'"},{name:"literal",value:"'large'"}]},description:"组件尺寸",defaultValue:{value:"'medium'",computed:!1}},className:{required:!1,tsType:{name:"string"},description:"外层容器 className（可用于自定义触发器样式）"},menuClassName:{required:!1,tsType:{name:"string"},description:`下拉菜单的额外 className（菜单通过 portal 渲染到 body，
可用于在父组件上下文中添加特定样式，比如在分页中使用紧凑样式）`}}};export{ke as S};
