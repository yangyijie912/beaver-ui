import{j as l}from"./jsx-runtime-u17CrQMm.js";import{r as b,R as xe}from"./iframe-CkYmOMph.js";import{r as qe}from"./index-EYGWMsiT.js";import{u as Ne}from"./useMenuPosition-DdeeBUrx.js";import{a as Ie,d as Se}from"./Spinner-Dq2vT7lv.js";function je({controlledValue:t,defaultValue:r}){const[a,u]=b.useState(t??r);return b.useEffect(()=>{t!==void 0&&u(t)},[t]),{internalValue:a,setInternalValue:u}}function Le({options:t,query:r,userTyped:a,filterOption:u,searchBy:i="both",allowCreate:g=!1,multiple:h=!1,filterSelected:T=!1,internalValue:y}){const w=Array.isArray(y)?y:[],n=b.useMemo(()=>{if(!r||!a){const p=t;return h&&T?p.filter(I=>!w.includes(I.value)):p}const m=r.trim().toLowerCase();if(u)return t.filter(p=>u(m,p));if(i==="label")return t.filter(p=>p.label.toLowerCase().includes(m));if(i==="value")return t.filter(p=>p.value.toLowerCase().includes(m));const c=t.filter(p=>p.label.toLowerCase().includes(m)),R=t.filter(p=>!p.label.toLowerCase().includes(m)&&p.value.toLowerCase().includes(m)),x=[...c,...R];return h&&T?x.filter(p=>!w.includes(p.value)):x},[t,r,a,u,i,h,T,y]),o=b.useMemo(()=>{const m=n,c=r.trim();return g&&c&&m.length===0?[{label:c,value:c,__isNew:!0}]:m},[n,g,r]);return{filteredOptions:n,displayOptions:o}}function Me({displayOptions:t,open:r,setOpen:a,handleSelectByValue:u,isDisabled:i=!1,onBackspace:g,onChar:h}){const[T,y]=b.useState(null),w=b.useCallback(n=>{if(!i){if(r&&n.key==="Backspace"&&(n.preventDefault(),g)){g(n);return}if(r&&n.key.length===1&&!n.ctrlKey&&!n.metaKey&&!n.altKey&&h){n.preventDefault(),h(n);return}if(n.key==="ArrowDown"){if(n.preventDefault(),!r){a(!0);return}y(o=>{const m=t,c=o===null?-1:o;for(let R=c+1;R<m.length;R++)if(!m[R].disabled)return R;return o})}else if(n.key==="ArrowUp"){if(n.preventDefault(),!r){a(!0);return}y(o=>{const m=t,c=o===null?m.length:o;for(let R=c-1;R>=0;R--)if(!m[R].disabled)return R;return o})}else if(n.key==="Enter"||n.key===" "){if(n.preventDefault(),!r)a(!0);else if(T!==null){const o=t[T];o&&!o.disabled&&u(o.value)}}else if(n.key==="Escape")a(!1);else if(n.key==="Home"){n.preventDefault();const o=t.findIndex(m=>!m.disabled);y(o>=0?o:0)}else if(n.key==="End"){n.preventDefault();const o=t.map(m=>m.disabled?-1:1).lastIndexOf(1);y(o>=0?o:t.length-1)}}},[t,r,a,u,T,i,g,h]);return{highlighted:T,setHighlighted:y,onKeyDown:w}}function ke(t=700,r){const a=b.useRef(null),u=r??b.useRef(!1);function i(){a.current&&(window.clearTimeout(a.current),a.current=null)}function g(y){i(),a.current=window.setTimeout(()=>y(""),t)}function h({query:y,setQuery:w,options:n,setHighlighted:o}){const c=u.current?y.slice(0,-1):"";u.current=!0,w(c),g(w);const x=(c?n.filter(p=>p.label.toLowerCase().includes(c.trim().toLowerCase())||p.value.toLowerCase().includes(c.trim().toLowerCase())):n).findIndex(p=>!p.disabled);o(x>=0?x:0)}function T({key:y,query:w,setQuery:n,options:o,multiple:m,searchable:c,setHighlighted:R}){const x=!u.current&&!m&&c?y:w+y;u.current=!0,n(x),g(n);const p=x.trim().toLowerCase(),$=(p?o.filter(E=>E.label.toLowerCase().includes(p)||E.value.toLowerCase().includes(p)):o).findIndex(E=>!E.disabled);R($>=0?$:0)}return{handleBackspace:h,handleChar:T,clear:i,userTypedRef:u}}const ee={open:!1,query:"",highlighted:null,inputFocused:!1};function Ae(t,r){switch(r.type){case"SET_OPEN":return{...t,open:r.payload};case"TOGGLE_OPEN":return{...t,open:!t.open};case"SET_QUERY":return{...t,query:r.payload};case"CLEAR_QUERY":return{...t,query:""};case"SET_HIGHLIGHTED":return{...t,highlighted:r.payload};case"SET_INPUT_FOCUSED":return{...t,inputFocused:r.payload};case"RESET":return{...ee};default:return t}}function Ce(){const[t,r]=b.useReducer(Ae,ee);return{state:t,setOpen:a=>r({type:"SET_OPEN",payload:a}),toggleOpen:()=>r({type:"TOGGLE_OPEN"}),setQuery:a=>r({type:"SET_QUERY",payload:a}),clearQuery:()=>r({type:"CLEAR_QUERY"}),setHighlighted:a=>{r(typeof a=="function"?{type:"SET_HIGHLIGHTED",payload:a(t.highlighted)}:{type:"SET_HIGHLIGHTED",payload:a})},setInputFocused:a=>r({type:"SET_INPUT_FOCUSED",payload:a}),reset:()=>r({type:"RESET"})}}const te=({id:t,option:r,index:a,highlighted:u,isSelected:i,onMouseEnter:g,onMouseDown:h,renderHighlightedLabel:T})=>{const y=r.__isNew===!0,w=r.disabled;return l.jsxs("li",{id:t,role:"option","aria-disabled":w,"aria-selected":i,className:`beaver-select__option ${i?"beaver-select__option--selected":""} ${w?"beaver-select__option--disabled":""} ${u===a?"beaver-select__option--highlighted":""} ${y?"beaver-select__option--new":""}`,"data-disabled":w?"true":void 0,tabIndex:-1,onMouseEnter:()=>{w||g(a)},onMouseDown:n=>{w||(n.preventDefault(),n.stopPropagation(),h(n,r.value,w))},onPointerDown:n=>{r.disabled||(n.preventDefault(),n.stopPropagation(),h(n,r.value,w))},onTouchStart:n=>{r.disabled||(n.preventDefault(),n.stopPropagation(),h(n,r.value,w))},onClick:n=>n.stopPropagation(),children:[l.jsx("span",{className:"beaver-select__opt-label",children:y?l.jsx("span",{className:"beaver-select__create-label",children:`使用 "${r.label}"`}):T(r.label)}),i&&l.jsx("span",{className:"beaver-select__opt-checkmark","aria-hidden":!0,children:l.jsx(Ie,{width:16,height:16,"aria-hidden":!0})})]},r.value)};te.__docgenInfo={description:"",methods:[],displayName:"OptionItem",props:{id:{required:!0,tsType:{name:"string"},description:""},option:{required:!0,tsType:{name:"intersection",raw:"SelectOption & { __isNew?: true }",elements:[{name:"signature",type:"object",raw:`{
  label: string;
  value: string;
  disabled?: boolean;
}`,signature:{properties:[{key:"label",value:{name:"string",required:!0}},{key:"value",value:{name:"string",required:!0}},{key:"disabled",value:{name:"boolean",required:!1}}]}},{name:"signature",type:"object",raw:"{ __isNew?: true }",signature:{properties:[{key:"__isNew",value:{name:"literal",value:"true",required:!1}}]}}]},description:""},index:{required:!0,tsType:{name:"number"},description:""},highlighted:{required:!0,tsType:{name:"union",raw:"number | null",elements:[{name:"number"},{name:"null"}]},description:""},isSelected:{required:!0,tsType:{name:"boolean"},description:""},onMouseEnter:{required:!0,tsType:{name:"signature",type:"function",raw:"(index: number) => void",signature:{arguments:[{type:{name:"number"},name:"index"}],return:{name:"void"}}},description:""},onMouseDown:{required:!0,tsType:{name:"signature",type:"function",raw:"(e: React.MouseEvent, value: string, disabled?: boolean) => void",signature:{arguments:[{type:{name:"ReactMouseEvent",raw:"React.MouseEvent"},name:"e"},{type:{name:"string"},name:"value"},{type:{name:"boolean"},name:"disabled"}],return:{name:"void"}}},description:""},renderHighlightedLabel:{required:!0,tsType:{name:"signature",type:"function",raw:"(label: string) => React.ReactNode",signature:{arguments:[{type:{name:"string"},name:"label"}],return:{name:"ReactReactNode",raw:"React.ReactNode"}}},description:""}}};const ne=({menuOptions:t,highlighted:r,internalValue:a,onHighlight:u,onSelectByValue:i,renderHighlightedLabel:g,noDataLabel:h,listRef:T,menuStyle:y,menuClassName:w})=>l.jsxs("ul",{role:"listbox",className:`beaver-select__menu ${w??""}`,style:y,ref:T,tabIndex:-1,"aria-activedescendant":r!==null?`beaver-select-opt-${r}`:void 0,onPointerDownCapture:n=>{const o=n.composedPath?n.composedPath():n.composedPath?.();o&&Array.isArray(o)&&o.some(c=>c&&c.getAttribute&&c.getAttribute("data-disabled")==="true")&&(n.preventDefault(),n.stopPropagation())},onTouchStartCapture:n=>{const o=n.composedPath?n.composedPath():n.composedPath?.();o&&Array.isArray(o)&&o.some(c=>c&&c.getAttribute&&c.getAttribute("data-disabled")==="true")&&(n.preventDefault(),n.stopPropagation())},children:[t.map((n,o)=>{const c=n.__isNew===!0?`__create-${n.value}`:n.value,R=Array.isArray(a)?a.includes(n.value):n.value===a;return l.jsx(te,{id:`beaver-select-opt-${o}`,option:n,index:o,highlighted:r,isSelected:R,onMouseEnter:x=>u(x),onMouseDown:(x,p,I)=>{I||i(n.value)},renderHighlightedLabel:g},c)}),t.length===0&&l.jsx("li",{className:"beaver-select__option beaver-select__no-data","aria-disabled":!0,children:l.jsx("span",{className:"beaver-select__opt-label",children:h??"暂无数据"})},"__no_data_or_match")]});ne.__docgenInfo={description:"",methods:[],displayName:"OptionList",props:{menuOptions:{required:!0,tsType:{name:"Array",elements:[{name:"unknown"}],raw:"(SelectOption & { __isNew?: true })[]"},description:""},highlighted:{required:!0,tsType:{name:"union",raw:"number | null",elements:[{name:"number"},{name:"null"}]},description:""},internalValue:{required:!1,tsType:{name:"union",raw:"string | string[] | undefined",elements:[{name:"string"},{name:"Array",elements:[{name:"string"}],raw:"string[]"},{name:"undefined"}]},description:""},onHighlight:{required:!0,tsType:{name:"signature",type:"function",raw:"(i: number) => void",signature:{arguments:[{type:{name:"number"},name:"i"}],return:{name:"void"}}},description:""},onSelectByValue:{required:!0,tsType:{name:"signature",type:"function",raw:"(value: string) => void",signature:{arguments:[{type:{name:"string"},name:"value"}],return:{name:"void"}}},description:""},renderHighlightedLabel:{required:!0,tsType:{name:"signature",type:"function",raw:"(label: string) => React.ReactNode",signature:{arguments:[{type:{name:"string"},name:"label"}],return:{name:"ReactReactNode",raw:"React.ReactNode"}}},description:""},noDataLabel:{required:!1,tsType:{name:"string"},description:"空数据时显示的提示文字，外部负责根据上下文（searchable/userTyped/query/options.length）计算"},listRef:{required:!1,tsType:{name:"ReactRef",raw:"React.Ref<HTMLUListElement>",elements:[{name:"HTMLUListElement"}]},description:"可选的 ul ref，供父组件（Select）聚焦或滚动使用"},menuStyle:{required:!1,tsType:{name:"ReactCSSProperties",raw:"React.CSSProperties"},description:"可选的样式，用于父组件传入动态宽度（例如与触发器宽度保持一致）"},menuClassName:{required:!1,tsType:{name:"string"},description:"可选的额外 className，供父组件（Select）标记菜单上下文（例如 size）"}}};const re=({values:t,options:r,onRemove:a})=>l.jsx("div",{className:"beaver-select__tags",children:t.map(u=>l.jsxs("span",{className:"beaver-select__tag",onClick:i=>i.stopPropagation(),children:[l.jsx("span",{className:"beaver-select__tag-label",children:r.find(i=>i.value===u)?.label??u}),l.jsx("button",{type:"button","aria-label":`remove ${u}`,className:"beaver-select__tag-remove",onClick:i=>{i.stopPropagation(),a(u,i)},children:"×"})]},u))});re.__docgenInfo={description:"",methods:[],displayName:"Tags",props:{values:{required:!0,tsType:{name:"Array",elements:[{name:"string"}],raw:"string[]"},description:""},options:{required:!0,tsType:{name:"Array",elements:[{name:"signature",type:"object",raw:`{
  label: string;
  value: string;
  disabled?: boolean;
}`,signature:{properties:[{key:"label",value:{name:"string",required:!0}},{key:"value",value:{name:"string",required:!0}},{key:"disabled",value:{name:"boolean",required:!1}}]}}],raw:"SelectOption[]"},description:""},onRemove:{required:!0,tsType:{name:"signature",type:"function",raw:"(value: string, e?: React.MouseEvent) => void",signature:{arguments:[{type:{name:"string"},name:"value"},{type:{name:"ReactMouseEvent",raw:"React.MouseEvent"},name:"e"}],return:{name:"void"}}},description:""}}};const ae=({multiple:t,query:r,onChangeEvent:a,searchRef:u,onKeyDown:i,onFocus:g,onBlur:h,placeholder:T,selectedValues:y=[],options:w=[],removeTag:n,onMouseDown:o,onClick:m})=>t?l.jsxs("div",{className:"beaver-select__tags-input",onMouseDown:o,onClick:m,children:[l.jsx(re,{values:y,options:w,onRemove:n??(()=>{})}),l.jsx("input",{ref:u,className:"beaver-select__input",value:r,onChange:c=>a?a(c):void 0,onFocus:g,onBlur:h,onKeyDown:i,placeholder:y.length===0&&!r?T:""})]}):l.jsx("input",{ref:u,className:"beaver-select__input",value:r,onChange:c=>a?a(c):void 0,onFocus:g,onBlur:h,onKeyDown:i,onMouseDown:c=>c.stopPropagation(),onClick:c=>c.stopPropagation(),placeholder:T});ae.__docgenInfo={description:"",methods:[],displayName:"SearchInput",props:{multiple:{required:!1,tsType:{name:"boolean"},description:""},query:{required:!0,tsType:{name:"string"},description:""},onChangeEvent:{required:!1,tsType:{name:"signature",type:"function",raw:"(e: React.ChangeEvent<HTMLInputElement>) => void",signature:{arguments:[{type:{name:"ReactChangeEvent",raw:"React.ChangeEvent<HTMLInputElement>",elements:[{name:"HTMLInputElement"}]},name:"e"}],return:{name:"void"}}},description:"接收原生 input 的 ChangeEvent。父组件可通过事件对象读取 value 并决定如何处理（例如替换行为）"},searchRef:{required:!1,tsType:{name:"ReactRefObject",raw:"React.RefObject<HTMLInputElement | null>",elements:[{name:"union",raw:"HTMLInputElement | null",elements:[{name:"HTMLInputElement"},{name:"null"}]}]},description:"允许传入可能为 null 的 ref（Select 中常用 RefObject<HTMLInputElement | null>）"},onKeyDown:{required:!1,tsType:{name:"signature",type:"function",raw:"(e: React.KeyboardEvent<HTMLInputElement>) => void",signature:{arguments:[{type:{name:"ReactKeyboardEvent",raw:"React.KeyboardEvent<HTMLInputElement>",elements:[{name:"HTMLInputElement"}]},name:"e"}],return:{name:"void"}}},description:""},onFocus:{required:!1,tsType:{name:"signature",type:"function",raw:"() => void",signature:{arguments:[],return:{name:"void"}}},description:""},onBlur:{required:!1,tsType:{name:"signature",type:"function",raw:"(e: React.FocusEvent<HTMLInputElement>) => void",signature:{arguments:[{type:{name:"ReactFocusEvent",raw:"React.FocusEvent<HTMLInputElement>",elements:[{name:"HTMLInputElement"}]},name:"e"}],return:{name:"void"}}},description:""},placeholder:{required:!1,tsType:{name:"string"},description:""},selectedValues:{required:!1,tsType:{name:"Array",elements:[{name:"string"}],raw:"string[]"},description:"",defaultValue:{value:"[]",computed:!1}},options:{required:!1,tsType:{name:"Array",elements:[{name:"signature",type:"object",raw:`{
  label: string;
  value: string;
  disabled?: boolean;
}`,signature:{properties:[{key:"label",value:{name:"string",required:!0}},{key:"value",value:{name:"string",required:!0}},{key:"disabled",value:{name:"boolean",required:!1}}]}}],raw:"SelectOption[]"},description:"",defaultValue:{value:"[]",computed:!1}},removeTag:{required:!1,tsType:{name:"signature",type:"function",raw:"(value: string, e?: React.MouseEvent) => void",signature:{arguments:[{type:{name:"string"},name:"value"},{type:{name:"ReactMouseEvent",raw:"React.MouseEvent"},name:"e"}],return:{name:"void"}}},description:""},onMouseDown:{required:!1,tsType:{name:"signature",type:"function",raw:"(e: React.MouseEvent) => void",signature:{arguments:[{type:{name:"ReactMouseEvent",raw:"React.MouseEvent"},name:"e"}],return:{name:"void"}}},description:""},onClick:{required:!1,tsType:{name:"signature",type:"function",raw:"(e: React.MouseEvent) => void",signature:{arguments:[{type:{name:"ReactMouseEvent",raw:"React.MouseEvent"},name:"e"}],return:{name:"void"}}},description:""}}};const se=({selectedValues:t,options:r,onRemove:a})=>l.jsx("div",{className:"beaver-select__tags",children:t.map(u=>l.jsxs("span",{className:"beaver-select__tag",onClick:i=>i.stopPropagation(),children:[l.jsx("span",{className:"beaver-select__tag-label",children:r.find(i=>i.value===u)?.label??u}),l.jsx("button",{type:"button","aria-label":`remove ${u}`,className:"beaver-select__tag-remove",onClick:i=>a(u,i),children:"×"})]},u))});se.__docgenInfo={description:"多选标签显示组件",methods:[],displayName:"SelectTags",props:{selectedValues:{required:!0,tsType:{name:"Array",elements:[{name:"string"}],raw:"string[]"},description:"已选值数组"},options:{required:!0,tsType:{name:"Array",elements:[{name:"signature",type:"object",raw:`{
  label: string;
  value: string;
  disabled?: boolean;
}`,signature:{properties:[{key:"label",value:{name:"string",required:!0}},{key:"value",value:{name:"string",required:!0}},{key:"disabled",value:{name:"boolean",required:!1}}]}}],raw:"SelectOption[]"},description:"选项列表"},onRemove:{required:!0,tsType:{name:"signature",type:"function",raw:"(value: string, e?: React.MouseEvent) => void",signature:{arguments:[{type:{name:"string"},name:"value"},{type:{name:"ReactMouseEvent",raw:"React.MouseEvent"},name:"e"}],return:{name:"void"}}},description:"移除标签回调"}}};const ie=({loading:t,loadingIcon:r,icon:a})=>l.jsx("div",{className:"beaver-select__icons",children:t?r?l.jsx("span",{className:"beaver-select__loading-icon",children:r}):l.jsx("span",{className:"beaver-select__spinner","aria-hidden":!0}):a?l.jsx("span",{className:"beaver-select__icon",children:a}):l.jsx("span",{className:"beaver-select__arrow","aria-hidden":!0,children:l.jsx(Se,{className:"beaver-select__arrow-svg",width:14,height:14,"aria-hidden":!0})})});ie.__docgenInfo={description:`Select 组件的图标区（右侧）
支持：loading 状态、自定义图标`,methods:[],displayName:"SelectIcons",props:{loading:{required:!0,tsType:{name:"boolean"},description:"是否加载中"},loadingIcon:{required:!1,tsType:{name:"ReactReactNode",raw:"React.ReactNode"},description:"自定义 loading 图标"},icon:{required:!1,tsType:{name:"ReactReactNode",raw:"React.ReactNode"},description:"自定义图标"}}};function le(t,r){const a=r.trim();if(!a)return t;const i=t.toLowerCase().indexOf(a.toLowerCase());if(i===-1)return t;const g=t.slice(0,i),h=t.slice(i,i+a.length),T=t.slice(i+a.length);return l.jsxs(l.Fragment,{children:[g,l.jsx("span",{className:"beaver-select__match",children:h}),T]})}function De(t){return t===void 0?{}:{width:typeof t=="number"?`${t}px`:t}}function Pe(t,r,a,u){return["beaver-select-wrapper",`beaver-select--${t}`,r?"beaver-select--disabled":"",a?"beaver-select--open":"",u||""].filter(Boolean).join(" ")}function He(t,r,a,u){return t?"暂无数据":r&&a&&u.trim()?"无匹配项":"暂无数据"}le.__docgenInfo={description:"高亮渲染 label 中匹配的子串",methods:[],displayName:"renderHighlightedLabel"};const ue=xe.forwardRef(({options:t=[],placeholder:r="请选择",value:a,defaultValue:u,onChange:i,searchable:g=!1,allowCreate:h=!1,filterOption:T,searchBy:y="both",disabled:w=!1,loading:n=!1,icon:o,loadingIcon:m,className:c,size:R="medium",menuClassName:x,name:p,width:I,style:$,multiple:E=!1,filterSelected:W=!1,...oe},U)=>{const{state:ce,setOpen:C,setQuery:S,setHighlighted:j,setInputFocused:F}=Ce(),{open:_,query:q,highlighted:K}=ce,{internalValue:f,setInternalValue:A}=je({controlledValue:a,defaultValue:u}),M=b.useRef(null),de=e=>{M.current=e,U&&(typeof U=="function"?U(e):U.current=e)},B=b.useRef(null),P=b.useRef(!1),k=b.useRef(!1),Y=b.useRef(null),J=b.useRef(null),me=b.useRef(null),{handleBackspace:pe,handleChar:fe}=ke(700,k),[L,G]=b.useState(null),z=Ne(M,J,_,6);b.useEffect(()=>{const e=M.current;if(e)return _&&L!==null&&I===void 0&&(e.style.setProperty("width",`${L}px`),e.style.setProperty("box-sizing","border-box")),!_&&I===void 0&&(e.style.removeProperty("width"),e.style.removeProperty("box-sizing")),()=>{I===void 0&&(e.style.removeProperty("width"),e.style.removeProperty("box-sizing"))}},[_,L,I]),b.useEffect(()=>{if(!_||I!==void 0)return;const e=M.current;if(!e)return;const s=new ResizeObserver(()=>{const d=e.getBoundingClientRect().width;G(d)});return s.observe(e),()=>{s.disconnect()}},[_,I]);const[,ve]=b.useState(0);b.useEffect(()=>{if(!_)return;const e=M.current;if(!e)return;const s=()=>{ve(v=>v+1)},d=new MutationObserver(s);return d.observe(e,{childList:!0,subtree:!0,characterData:!0,attributes:!0}),()=>{d.disconnect()}},[_]),b.useEffect(()=>{function e(s){M.current&&(M.current.contains(s.target)||C(!1))}return document.addEventListener("mousedown",e),()=>{document.removeEventListener("mousedown",e)}},[_]),b.useEffect(()=>{if(!_)return;function e(){const s=M.current;s&&G(s.getBoundingClientRect().width)}return window.addEventListener("resize",e),()=>window.removeEventListener("resize",e)},[_]);const{displayOptions:H}=Le({options:t,query:q,userTyped:k.current,filterOption:T,searchBy:y,allowCreate:h,multiple:E,filterSelected:W,internalValue:f});b.useEffect(()=>{if(!_){if(P.current){P.current=!1,j(null);return}if(h&&q.trim()){const e=q.trim(),s=t.find(d=>d.value===e||d.label===e);s&&!s.disabled?(a===void 0&&A(s.value),i?.(s.value)):(a===void 0&&A(e),i?.(e))}S(""),j(null)}},[_]),b.useEffect(()=>()=>{Y.current&&window.clearTimeout(Y.current)},[]);const V=Array.isArray(f)?t.find(e=>e.value===f[0]):t.find(e=>e.value===f),Q=Array.isArray(f)?f:[],O=w||n;function ge(){if(!O)if(_)C(!1);else{const e=M.current;if(e){const s=e.getBoundingClientRect().width;G(s)}C(!0),setTimeout(()=>{const s=M.current;s&&s.getBoundingClientRect().width},0)}}function D(e){const s=t.find(v=>v.value===e);if(s&&s.disabled)return;if(E===!0){const v=Array.isArray(f)?[...f]:[],N=v.indexOf(e);N>=0?v.splice(N,1):v.push(e),a===void 0&&A(v),i?.(v),S(""),P.current=!0,W&&C(!1);return}a===void 0&&A(e),i?.(e),g&&(k.current=!1),S(""),P.current=!0,C(!1)}const{onKeyDown:ye}=Me({displayOptions:H,open:_,setOpen:C,handleSelectByValue:D,isDisabled:O,onBackspace:e=>{e.preventDefault(),pe({query:q,setQuery:S,options:t,setHighlighted:j})},onChar:e=>{e.preventDefault(),fe({key:e.key,query:q,setQuery:S,options:t,multiple:E,searchable:g,setHighlighted:j})}});b.useEffect(()=>{if(_&&K===null){const e=H,s=e.findIndex(v=>Array.isArray(f)?f.includes(v.value):v.value===f),d=e.findIndex(v=>!v.disabled);j(s>=0?s:d>=0?d:0)}_&&g&&setTimeout(()=>B.current?.focus(),0)},[_]);const be=H;function X(e,s){s?.stopPropagation();const d=Array.isArray(f)?[...f]:[],v=d.indexOf(e);v>=0&&d.splice(v,1),a===void 0&&A(d),i?.(d)}const he=(e,s)=>{X(e,s)},we=e=>{k.current=!0,S(e.target.value),j(0)},_e=e=>{const s=e.target.value;if(!k.current&&!E&&g){let d=s.replace(q,"");d===""&&(d=s),k.current=!0,S(d),j(0);return}k.current=!0,S(s),j(0)},Te=()=>{F(!0),!k.current&&g&&!E&&q&&setTimeout(()=>B.current?.select(),0)},Re=e=>{if(e.stopPropagation(),P.current){P.current=!1,F(!1);return}const s=q.trim();if(h&&s){const d=t.find(v=>v.value===s||v.label===s);d&&!d.disabled?E?D(d.value):(a===void 0&&A(d.value),i?.(d.value)):E?D(s):(a===void 0&&A(s),i?.(s))}S(""),F(!1)},Ee=e=>{if(e.stopPropagation(),e.key==="ArrowDown")e.preventDefault(),j(s=>{const d=H,v=s===null?-1:s;for(let N=v+1;N<d.length;N++)if(!d[N].disabled)return N;return s});else if(e.key==="ArrowUp")e.preventDefault(),j(s=>{const d=H,v=s===null?d.length:s;for(let N=v-1;N>=0;N--)if(!d[N].disabled)return N;return s});else if(e.key==="Enter"){e.preventDefault();const s=q.trim();if(h&&s&&!t.find(Z=>Z.value===s||Z.label===s)){D(s),S("");return}const v=H[K??0];v&&!v.disabled&&D(v.value)}else e.key==="Escape"&&C(!1)};return l.jsxs("div",{className:Pe(R,O,_,c),ref:de,"aria-disabled":O,style:{...$,...De(I)},children:[l.jsxs("div",{role:"button",className:"beaver-select__control","aria-haspopup":"listbox","aria-expanded":_,onClick:ge,onKeyDown:ye,tabIndex:O?-1:0,...oe,children:[l.jsx("div",{className:"beaver-select__display",children:g&&_?l.jsx(ae,{multiple:E,query:q,onChangeEvent:E?we:_e,searchRef:B,onKeyDown:Ee,onFocus:Te,onBlur:Re,placeholder:q?"":f&&!Array.isArray(f)?t.find(e=>e.value===f)?.label??String(f):r,selectedValues:Q,options:t,removeTag:he,onMouseDown:e=>e.stopPropagation(),onClick:e=>e.stopPropagation()}):Array.isArray(f)?Q.length===0?l.jsx("span",{className:"beaver-select__value beaver-select__placeholder",children:r}):l.jsx(se,{selectedValues:Q,options:t,onRemove:X}):l.jsx("span",{className:`beaver-select__value ${f??V?"":"beaver-select__placeholder"}`,children:f?t.find(e=>e.value===f)?.label??f:V?V.label:r})}),l.jsx(ie,{loading:n,loadingIcon:m,icon:o})]}),_&&qe.createPortal(l.jsx("div",{ref:J,style:{position:"fixed",left:`${z.x}px`,top:`${z.y}px`,visibility:z.measured?"visible":"hidden",pointerEvents:z.measured?void 0:"none",zIndex:"var(--beaver-select-z-index, 5000)",width:L?`${L}px`:"auto",boxSizing:"border-box",minWidth:L?`${L}px`:void 0},children:l.jsx(ne,{menuOptions:be,highlighted:K,internalValue:f,onHighlight:e=>j(e),onSelectByValue:e=>D(e),renderHighlightedLabel:e=>le(e,q),noDataLabel:He(t.length===0,g,k.current,q),listRef:me,menuStyle:{width:L?`${L}px`:"auto",boxSizing:"border-box",minWidth:L?`${L}px`:void 0},menuClassName:x})}),document.body),E===!0?l.jsx("select",{name:p,multiple:!0,value:Array.isArray(f)?f:[],onChange:e=>{const s=Array.from(e.target.selectedOptions,d=>d.value);a===void 0&&A(s),i?.(s)},style:{display:"none"},"aria-hidden":!0,children:t.map(e=>l.jsx("option",{value:e.value,children:e.label},e.value))}):l.jsx("select",{name:p,value:(Array.isArray(f)?f[0]:f)??"",onChange:e=>{D(e.target.value)},style:{display:"none"},"aria-hidden":!0})]})});ue.displayName="Select";ue.__docgenInfo={description:"",methods:[],displayName:"Select",props:{options:{required:!1,tsType:{name:"Array",elements:[{name:"signature",type:"object",raw:`{
  label: string;
  value: string;
  disabled?: boolean;
}`,signature:{properties:[{key:"label",value:{name:"string",required:!0}},{key:"value",value:{name:"string",required:!0}},{key:"disabled",value:{name:"boolean",required:!1}}]}}],raw:"SelectOption[]"},description:"下拉选项列表",defaultValue:{value:"[]",computed:!1}},placeholder:{required:!1,tsType:{name:"string"},description:"占位符",defaultValue:{value:"'请选择'",computed:!1}},value:{required:!1,tsType:{name:"union",raw:"string | string[]",elements:[{name:"string"},{name:"Array",elements:[{name:"string"}],raw:"string[]"}]},description:"单选时为 string，复选时为 string[]"},defaultValue:{required:!1,tsType:{name:"union",raw:"string | string[]",elements:[{name:"string"},{name:"Array",elements:[{name:"string"}],raw:"string[]"}]},description:"默认值"},onChange:{required:!1,tsType:{name:"signature",type:"function",raw:"(value: string | string[]) => void",signature:{arguments:[{type:{name:"union",raw:"string | string[]",elements:[{name:"string"},{name:"Array",elements:[{name:"string"}],raw:"string[]"}]},name:"value"}],return:{name:"void"}}},description:"事件回调，参数为选中的值"},multiple:{required:!1,tsType:{name:"boolean"},description:"是否支持多选",defaultValue:{value:"false",computed:!1}},searchable:{required:!1,tsType:{name:"boolean"},description:"是否在下拉中显示搜索框",defaultValue:{value:"false",computed:!1}},allowCreate:{required:!1,tsType:{name:"boolean"},description:"是否允许在没有匹配项时创建自定义输入项（默认 false）",defaultValue:{value:"false",computed:!1}},filterOption:{required:!1,tsType:{name:"signature",type:"function",raw:"(input: string, option: SelectOption) => boolean",signature:{arguments:[{type:{name:"string"},name:"input"},{type:{name:"signature",type:"object",raw:`{
  label: string;
  value: string;
  disabled?: boolean;
}`,signature:{properties:[{key:"label",value:{name:"string",required:!0}},{key:"value",value:{name:"string",required:!0}},{key:"disabled",value:{name:"boolean",required:!1}}]}},name:"option"}],return:{name:"boolean"}}},description:"定制过滤函数：如果提供，将优先使用"},searchBy:{required:!1,tsType:{name:"union",raw:"'label' | 'value' | 'both'",elements:[{name:"literal",value:"'label'"},{name:"literal",value:"'value'"},{name:"literal",value:"'both'"}]},description:"搜索策略：'label' 只按 label 搜索，'value' 只按 value，'both' 按 label 与 value 搜索但优先 label 匹配",defaultValue:{value:"'both'",computed:!1}},filterSelected:{required:!1,tsType:{name:"boolean"},description:"仅在 `multiple` 为 true 时生效：在下拉中隐藏已选项，并在每次多选后关闭下拉。",defaultValue:{value:"false",computed:!1}},disabled:{required:!1,tsType:{name:"boolean"},description:"是否禁用",defaultValue:{value:"false",computed:!1}},loading:{required:!1,tsType:{name:"boolean"},description:"是否加载中",defaultValue:{value:"false",computed:!1}},icon:{required:!1,tsType:{name:"ReactReactNode",raw:"React.ReactNode"},description:"自定义箭头/后缀图标（传入 ReactNode）"},loadingIcon:{required:!1,tsType:{name:"ReactReactNode",raw:"React.ReactNode"},description:"自定义 loading 图标（传入 ReactNode），优先于默认 spinner"},width:{required:!1,tsType:{name:"union",raw:"number | string",elements:[{name:"number"},{name:"string"}]},description:"直接设置组件宽度，支持 number(像素) 或 字符串(如 '50%','200px')"},size:{required:!1,tsType:{name:"union",raw:"'small' | 'medium' | 'large'",elements:[{name:"literal",value:"'small'"},{name:"literal",value:"'medium'"},{name:"literal",value:"'large'"}]},description:"组件尺寸",defaultValue:{value:"'medium'",computed:!1}},className:{required:!1,tsType:{name:"string"},description:"外层容器 className（可用于自定义触发器样式）"},menuClassName:{required:!1,tsType:{name:"string"},description:`下拉菜单的额外 className（菜单通过 portal 渲染到 body，
可用于在父组件上下文中添加特定样式，比如在分页中使用紧凑样式）`}}};export{ue as S};
