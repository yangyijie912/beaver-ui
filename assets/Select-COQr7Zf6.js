import{j as u}from"./jsx-runtime-u17CrQMm.js";import{r as w}from"./iframe-BKpi8Zge.js";import{r as be}from"./index-DuoL47QS.js";function he({controlledValue:e,defaultValue:n}){const[r,o]=w.useState(e??n);return w.useEffect(()=>{e!==void 0&&o(e)},[e]),{internalValue:r,setInternalValue:o}}function we({options:e,query:n,userTyped:r,filterOption:o,searchBy:i="both",allowCreate:y=!1,multiple:h=!1,filterSelected:_=!1,internalValue:b}){const l=Array.isArray(b)?b:[],a=w.useMemo(()=>{if(!n||!r){const m=e;return h&&_?m.filter($=>!l.includes($.value)):m}const d=n.trim().toLowerCase();if(o)return e.filter(m=>o(d,m));if(i==="label")return e.filter(m=>m.label.toLowerCase().includes(d));if(i==="value")return e.filter(m=>m.value.toLowerCase().includes(d));const f=e.filter(m=>m.label.toLowerCase().includes(d)),T=e.filter(m=>!m.label.toLowerCase().includes(d)&&m.value.toLowerCase().includes(d)),N=[...f,...T];return h&&_?N.filter(m=>!l.includes(m.value)):N},[e,n,r,o,i,h,_,b]),p=w.useMemo(()=>{const d=a,f=n.trim();return y&&f&&d.length===0?[{label:f,value:f,__isNew:!0}]:d},[a,y,n]);return{filteredOptions:a,displayOptions:p}}function _e({displayOptions:e,open:n,setOpen:r,handleSelectByValue:o,isDisabled:i=!1,onBackspace:y,onChar:h}){const[_,b]=w.useState(null),l=w.useCallback(a=>{if(!i){if(n&&a.key==="Backspace"&&(a.preventDefault(),y)){y(a);return}if(n&&a.key.length===1&&!a.ctrlKey&&!a.metaKey&&!a.altKey&&h){a.preventDefault(),h(a);return}if(a.key==="ArrowDown"){if(a.preventDefault(),!n){r(!0);return}b(p=>{const d=e,f=p===null?-1:p;for(let T=f+1;T<d.length;T++)if(!d[T].disabled)return T;return p})}else if(a.key==="ArrowUp"){if(a.preventDefault(),!n){r(!0);return}b(p=>{const d=e,f=p===null?d.length:p;for(let T=f-1;T>=0;T--)if(!d[T].disabled)return T;return p})}else if(a.key==="Enter"||a.key===" "){if(a.preventDefault(),!n)r(!0);else if(_!==null){const p=e[_];p&&!p.disabled&&o(p.value)}}else if(a.key==="Escape")r(!1);else if(a.key==="Home"){a.preventDefault();const p=e.findIndex(d=>!d.disabled);b(p>=0?p:0)}else if(a.key==="End"){a.preventDefault();const p=e.map(d=>d.disabled?-1:1).lastIndexOf(1);b(p>=0?p:e.length-1)}}},[e,n,r,o,_,i,y,h]);return{highlighted:_,setHighlighted:b,onKeyDown:l}}function Te(e=700,n){const r=w.useRef(null),o=n??w.useRef(!1);function i(){r.current&&(window.clearTimeout(r.current),r.current=null)}function y(b){i(),r.current=window.setTimeout(()=>b(""),e)}function h({query:b,setQuery:l,options:a,setHighlighted:p}){const f=o.current?b.slice(0,-1):"";o.current=!0,l(f),y(l);const N=(f?a.filter(m=>m.label.toLowerCase().includes(f.trim().toLowerCase())||m.value.toLowerCase().includes(f.trim().toLowerCase())):a).findIndex(m=>!m.disabled);p(N>=0?N:0)}function _({key:b,query:l,setQuery:a,options:p,multiple:d,searchable:f,setHighlighted:T}){const N=!o.current&&!d&&f?b:l+b;o.current=!0,a(N),y(a);const m=N.trim().toLowerCase(),x=(m?p.filter(k=>k.label.toLowerCase().includes(m)||k.value.toLowerCase().includes(m)):p).findIndex(k=>!k.disabled);T(x>=0?x:0)}return{handleBackspace:h,handleChar:_,clear:i,userTypedRef:o}}const Y={open:!1,query:"",highlighted:null,inputFocused:!1};function Re(e,n){switch(n.type){case"SET_OPEN":return{...e,open:n.payload};case"TOGGLE_OPEN":return{...e,open:!e.open};case"SET_QUERY":return{...e,query:n.payload};case"CLEAR_QUERY":return{...e,query:""};case"SET_HIGHLIGHTED":return{...e,highlighted:n.payload};case"SET_INPUT_FOCUSED":return{...e,inputFocused:n.payload};case"RESET":return{...Y};default:return e}}function Ee(){const[e,n]=w.useReducer(Re,Y);return{state:e,setOpen:r=>n({type:"SET_OPEN",payload:r}),toggleOpen:()=>n({type:"TOGGLE_OPEN"}),setQuery:r=>n({type:"SET_QUERY",payload:r}),clearQuery:()=>n({type:"CLEAR_QUERY"}),setHighlighted:r=>{n(typeof r=="function"?{type:"SET_HIGHLIGHTED",payload:r(e.highlighted)}:{type:"SET_HIGHLIGHTED",payload:r})},setInputFocused:r=>n({type:"SET_INPUT_FOCUSED",payload:r}),reset:()=>n({type:"RESET"})}}const X=({id:e,option:n,index:r,highlighted:o,isSelected:i,onMouseEnter:y,onMouseDown:h,renderHighlightedLabel:_})=>{const b=n.__isNew===!0,l=n.disabled;return u.jsxs("li",{id:e,role:"option","aria-disabled":l,"aria-selected":i,className:`beaver-select__option ${i?"beaver-select__option--selected":""} ${l?"beaver-select__option--disabled":""} ${o===r?"beaver-select__option--highlighted":""} ${b?"beaver-select__option--new":""}`,"data-disabled":l?"true":void 0,tabIndex:-1,onMouseEnter:()=>{l||y(r)},onMouseDown:a=>{l||(a.preventDefault(),a.stopPropagation(),h(a,n.value,l))},onPointerDown:a=>{n.disabled||(a.preventDefault(),a.stopPropagation(),h(a,n.value,l))},onTouchStart:a=>{n.disabled||(a.preventDefault(),a.stopPropagation(),h(a,n.value,l))},onClick:a=>a.stopPropagation(),children:[u.jsx("span",{className:"beaver-select__opt-prefix",children:i?"✔":""}),u.jsx("span",{className:"beaver-select__opt-label",children:b?u.jsx("span",{className:"beaver-select__create-label",children:`使用 "${n.label}"`}):_(n.label)})]},n.value)};X.__docgenInfo={description:"",methods:[],displayName:"OptionItem",props:{id:{required:!0,tsType:{name:"string"},description:""},option:{required:!0,tsType:{name:"intersection",raw:"SelectOption & { __isNew?: true }",elements:[{name:"signature",type:"object",raw:`{
  label: string;
  value: string;
  disabled?: boolean;
}`,signature:{properties:[{key:"label",value:{name:"string",required:!0}},{key:"value",value:{name:"string",required:!0}},{key:"disabled",value:{name:"boolean",required:!1}}]}},{name:"signature",type:"object",raw:"{ __isNew?: true }",signature:{properties:[{key:"__isNew",value:{name:"literal",value:"true",required:!1}}]}}]},description:""},index:{required:!0,tsType:{name:"number"},description:""},highlighted:{required:!0,tsType:{name:"union",raw:"number | null",elements:[{name:"number"},{name:"null"}]},description:""},isSelected:{required:!0,tsType:{name:"boolean"},description:""},onMouseEnter:{required:!0,tsType:{name:"signature",type:"function",raw:"(index: number) => void",signature:{arguments:[{type:{name:"number"},name:"index"}],return:{name:"void"}}},description:""},onMouseDown:{required:!0,tsType:{name:"signature",type:"function",raw:"(e: React.MouseEvent, value: string, disabled?: boolean) => void",signature:{arguments:[{type:{name:"ReactMouseEvent",raw:"React.MouseEvent"},name:"e"},{type:{name:"string"},name:"value"},{type:{name:"boolean"},name:"disabled"}],return:{name:"void"}}},description:""},renderHighlightedLabel:{required:!0,tsType:{name:"signature",type:"function",raw:"(label: string) => React.ReactNode",signature:{arguments:[{type:{name:"string"},name:"label"}],return:{name:"ReactReactNode",raw:"React.ReactNode"}}},description:""}}};const J=({menuOptions:e,highlighted:n,internalValue:r,onHighlight:o,onSelectByValue:i,renderHighlightedLabel:y,noDataLabel:h,listRef:_,menuStyle:b})=>u.jsxs("ul",{role:"listbox",className:"beaver-select__menu",style:b,ref:_,tabIndex:-1,"aria-activedescendant":n!==null?`beaver-select-opt-${n}`:void 0,onPointerDownCapture:l=>{const a=l.composedPath?l.composedPath():l.composedPath?.();a&&Array.isArray(a)&&a.some(d=>d&&d.getAttribute&&d.getAttribute("data-disabled")==="true")&&(l.preventDefault(),l.stopPropagation())},onTouchStartCapture:l=>{const a=l.composedPath?l.composedPath():l.composedPath?.();a&&Array.isArray(a)&&a.some(d=>d&&d.getAttribute&&d.getAttribute("data-disabled")==="true")&&(l.preventDefault(),l.stopPropagation())},children:[e.map((l,a)=>{const d=l.__isNew===!0?`__create-${l.value}`:l.value,f=Array.isArray(r)?r.includes(l.value):l.value===r;return u.jsx(X,{id:`beaver-select-opt-${a}`,option:l,index:a,highlighted:n,isSelected:f,onMouseEnter:T=>o(T),onMouseDown:(T,N,m)=>{m||i(l.value)},renderHighlightedLabel:y},d)}),e.length===0&&u.jsx("li",{className:"beaver-select__option beaver-select__no-data","aria-disabled":!0,children:u.jsx("span",{className:"beaver-select__opt-label",children:h??"暂无数据"})},"__no_data_or_match")]});J.__docgenInfo={description:"",methods:[],displayName:"OptionList",props:{menuOptions:{required:!0,tsType:{name:"Array",elements:[{name:"unknown"}],raw:"(SelectOption & { __isNew?: true })[]"},description:""},highlighted:{required:!0,tsType:{name:"union",raw:"number | null",elements:[{name:"number"},{name:"null"}]},description:""},internalValue:{required:!1,tsType:{name:"union",raw:"string | string[] | undefined",elements:[{name:"string"},{name:"Array",elements:[{name:"string"}],raw:"string[]"},{name:"undefined"}]},description:""},onHighlight:{required:!0,tsType:{name:"signature",type:"function",raw:"(i: number) => void",signature:{arguments:[{type:{name:"number"},name:"i"}],return:{name:"void"}}},description:""},onSelectByValue:{required:!0,tsType:{name:"signature",type:"function",raw:"(value: string) => void",signature:{arguments:[{type:{name:"string"},name:"value"}],return:{name:"void"}}},description:""},renderHighlightedLabel:{required:!0,tsType:{name:"signature",type:"function",raw:"(label: string) => React.ReactNode",signature:{arguments:[{type:{name:"string"},name:"label"}],return:{name:"ReactReactNode",raw:"React.ReactNode"}}},description:""},noDataLabel:{required:!1,tsType:{name:"string"},description:"空数据时显示的提示文字，外部负责根据上下文（searchable/userTyped/query/options.length）计算"},listRef:{required:!1,tsType:{name:"ReactRef",raw:"React.Ref<HTMLUListElement>",elements:[{name:"HTMLUListElement"}]},description:"可选的 ul ref，供父组件（Select）聚焦或滚动使用"},menuStyle:{required:!1,tsType:{name:"ReactCSSProperties",raw:"React.CSSProperties"},description:"可选的样式，用于父组件传入动态宽度（例如与触发器宽度保持一致）"}}};const Z=({values:e,options:n,onRemove:r})=>u.jsx("div",{className:"beaver-select__tags",children:e.map(o=>u.jsxs("span",{className:"beaver-select__tag",onClick:i=>i.stopPropagation(),children:[u.jsx("span",{className:"beaver-select__tag-label",children:n.find(i=>i.value===o)?.label??o}),u.jsx("button",{type:"button","aria-label":`remove ${o}`,className:"beaver-select__tag-remove",onClick:i=>{i.stopPropagation(),r(o,i)},children:"×"})]},o))});Z.__docgenInfo={description:"",methods:[],displayName:"Tags",props:{values:{required:!0,tsType:{name:"Array",elements:[{name:"string"}],raw:"string[]"},description:""},options:{required:!0,tsType:{name:"Array",elements:[{name:"signature",type:"object",raw:`{
  label: string;
  value: string;
  disabled?: boolean;
}`,signature:{properties:[{key:"label",value:{name:"string",required:!0}},{key:"value",value:{name:"string",required:!0}},{key:"disabled",value:{name:"boolean",required:!1}}]}}],raw:"SelectOption[]"},description:""},onRemove:{required:!0,tsType:{name:"signature",type:"function",raw:"(value: string, e?: React.MouseEvent) => void",signature:{arguments:[{type:{name:"string"},name:"value"},{type:{name:"ReactMouseEvent",raw:"React.MouseEvent"},name:"e"}],return:{name:"void"}}},description:""}}};const ee=({multiple:e,query:n,onChangeEvent:r,searchRef:o,onKeyDown:i,onFocus:y,onBlur:h,placeholder:_,selectedValues:b=[],options:l=[],removeTag:a,onMouseDown:p,onClick:d})=>e?u.jsxs("div",{className:"beaver-select__tags-input",onMouseDown:p,onClick:d,children:[u.jsx(Z,{values:b,options:l,onRemove:a??(()=>{})}),u.jsx("input",{ref:o,className:"beaver-select__input",value:n,onChange:f=>r?r(f):void 0,onFocus:y,onBlur:h,onKeyDown:i,placeholder:b.length===0&&!n?_:""})]}):u.jsx("input",{ref:o,className:"beaver-select__input",value:n,onChange:f=>r?r(f):void 0,onFocus:y,onBlur:h,onKeyDown:i,onMouseDown:f=>f.stopPropagation(),onClick:f=>f.stopPropagation(),placeholder:_});ee.__docgenInfo={description:"",methods:[],displayName:"SearchInput",props:{multiple:{required:!1,tsType:{name:"boolean"},description:""},query:{required:!0,tsType:{name:"string"},description:""},onChangeEvent:{required:!1,tsType:{name:"signature",type:"function",raw:"(e: React.ChangeEvent<HTMLInputElement>) => void",signature:{arguments:[{type:{name:"ReactChangeEvent",raw:"React.ChangeEvent<HTMLInputElement>",elements:[{name:"HTMLInputElement"}]},name:"e"}],return:{name:"void"}}},description:"接收原生 input 的 ChangeEvent。父组件可通过事件对象读取 value 并决定如何处理（例如替换行为）"},searchRef:{required:!1,tsType:{name:"ReactRefObject",raw:"React.RefObject<HTMLInputElement | null>",elements:[{name:"union",raw:"HTMLInputElement | null",elements:[{name:"HTMLInputElement"},{name:"null"}]}]},description:"允许传入可能为 null 的 ref（Select 中常用 RefObject<HTMLInputElement | null>）"},onKeyDown:{required:!1,tsType:{name:"signature",type:"function",raw:"(e: React.KeyboardEvent<HTMLInputElement>) => void",signature:{arguments:[{type:{name:"ReactKeyboardEvent",raw:"React.KeyboardEvent<HTMLInputElement>",elements:[{name:"HTMLInputElement"}]},name:"e"}],return:{name:"void"}}},description:""},onFocus:{required:!1,tsType:{name:"signature",type:"function",raw:"() => void",signature:{arguments:[],return:{name:"void"}}},description:""},onBlur:{required:!1,tsType:{name:"signature",type:"function",raw:"(e: React.FocusEvent<HTMLInputElement>) => void",signature:{arguments:[{type:{name:"ReactFocusEvent",raw:"React.FocusEvent<HTMLInputElement>",elements:[{name:"HTMLInputElement"}]},name:"e"}],return:{name:"void"}}},description:""},placeholder:{required:!1,tsType:{name:"string"},description:""},selectedValues:{required:!1,tsType:{name:"Array",elements:[{name:"string"}],raw:"string[]"},description:"",defaultValue:{value:"[]",computed:!1}},options:{required:!1,tsType:{name:"Array",elements:[{name:"signature",type:"object",raw:`{
  label: string;
  value: string;
  disabled?: boolean;
}`,signature:{properties:[{key:"label",value:{name:"string",required:!0}},{key:"value",value:{name:"string",required:!0}},{key:"disabled",value:{name:"boolean",required:!1}}]}}],raw:"SelectOption[]"},description:"",defaultValue:{value:"[]",computed:!1}},removeTag:{required:!1,tsType:{name:"signature",type:"function",raw:"(value: string, e?: React.MouseEvent) => void",signature:{arguments:[{type:{name:"string"},name:"value"},{type:{name:"ReactMouseEvent",raw:"React.MouseEvent"},name:"e"}],return:{name:"void"}}},description:""},onMouseDown:{required:!1,tsType:{name:"signature",type:"function",raw:"(e: React.MouseEvent) => void",signature:{arguments:[{type:{name:"ReactMouseEvent",raw:"React.MouseEvent"},name:"e"}],return:{name:"void"}}},description:""},onClick:{required:!1,tsType:{name:"signature",type:"function",raw:"(e: React.MouseEvent) => void",signature:{arguments:[{type:{name:"ReactMouseEvent",raw:"React.MouseEvent"},name:"e"}],return:{name:"void"}}},description:""}}};const te=({selectedValues:e,options:n,onRemove:r})=>u.jsx("div",{className:"beaver-select__tags",children:e.map(o=>u.jsxs("span",{className:"beaver-select__tag",onClick:i=>i.stopPropagation(),children:[u.jsx("span",{className:"beaver-select__tag-label",children:n.find(i=>i.value===o)?.label??o}),u.jsx("button",{type:"button","aria-label":`remove ${o}`,className:"beaver-select__tag-remove",onClick:i=>r(o,i),children:"×"})]},o))});te.__docgenInfo={description:"多选标签显示组件",methods:[],displayName:"SelectTags",props:{selectedValues:{required:!0,tsType:{name:"Array",elements:[{name:"string"}],raw:"string[]"},description:"已选值数组"},options:{required:!0,tsType:{name:"Array",elements:[{name:"signature",type:"object",raw:`{
  label: string;
  value: string;
  disabled?: boolean;
}`,signature:{properties:[{key:"label",value:{name:"string",required:!0}},{key:"value",value:{name:"string",required:!0}},{key:"disabled",value:{name:"boolean",required:!1}}]}}],raw:"SelectOption[]"},description:"选项列表"},onRemove:{required:!0,tsType:{name:"signature",type:"function",raw:"(value: string, e?: React.MouseEvent) => void",signature:{arguments:[{type:{name:"string"},name:"value"},{type:{name:"ReactMouseEvent",raw:"React.MouseEvent"},name:"e"}],return:{name:"void"}}},description:"移除标签回调"}}};const ne=({loading:e,loadingIcon:n,icon:r})=>u.jsx("div",{className:"beaver-select__icons",children:e?n?u.jsx("span",{className:"beaver-select__loading-icon",children:n}):u.jsx("span",{className:"beaver-select__spinner","aria-hidden":!0}):r?u.jsx("span",{className:"beaver-select__icon",children:r}):u.jsx("span",{className:"beaver-select__arrow","aria-hidden":!0,children:u.jsx("svg",{className:"beaver-select__arrow-svg",width:"14",height:"14",viewBox:"0 0 24 24",fill:"none",xmlns:"http://www.w3.org/2000/svg","aria-hidden":!0,children:u.jsx("path",{d:"M6 9l6 6 6-6",stroke:"currentColor",strokeWidth:2,strokeLinecap:"round",strokeLinejoin:"round"})})})});ne.__docgenInfo={description:`Select 组件的图标区（右侧）
支持：loading 状态、自定义图标`,methods:[],displayName:"SelectIcons",props:{loading:{required:!0,tsType:{name:"boolean"},description:"是否加载中"},loadingIcon:{required:!1,tsType:{name:"ReactReactNode",raw:"React.ReactNode"},description:"自定义 loading 图标"},icon:{required:!1,tsType:{name:"ReactReactNode",raw:"React.ReactNode"},description:"自定义图标"}}};function re(e,n){const r=n.trim();if(!r)return e;const i=e.toLowerCase().indexOf(r.toLowerCase());if(i===-1)return e;const y=e.slice(0,i),h=e.slice(i,i+r.length),_=e.slice(i+r.length);return u.jsxs(u.Fragment,{children:[y,u.jsx("span",{className:"beaver-select__match",children:h}),_]})}function xe(e){return e===void 0?{}:{width:typeof e=="number"?`${e}px`:e}}function qe(e,n,r,o){return["beaver-select-wrapper",`beaver-select--${e}`,n?"beaver-select--disabled":"",r?"beaver-select--open":"",o||""].filter(Boolean).join(" ")}function Ne(e,n,r,o){return e?"暂无数据":n&&r&&o.trim()?"无匹配项":"暂无数据"}re.__docgenInfo={description:"高亮渲染 label 中匹配的子串",methods:[],displayName:"renderHighlightedLabel"};const Ie=({options:e=[],placeholder:n="请选择",value:r,defaultValue:o,onChange:i,searchable:y=!1,allowCreate:h=!1,filterOption:_,searchBy:b="both",disabled:l=!1,loading:a=!1,icon:p,loadingIcon:d,className:f,size:T="medium",name:N,width:m,style:$,multiple:x=!1,filterSelected:k=!1,...ae})=>{const{state:se,setOpen:M,setQuery:I,setHighlighted:j,setInputFocused:F}=Ee(),{open:R,query:q,highlighted:B}=se,{internalValue:v,setInternalValue:A}=he({controlledValue:r,defaultValue:o}),S=w.useRef(null),ie=w.useRef(null),K=w.useRef(null),C=w.useRef(!1),L=w.useRef(!1),V=w.useRef(null),{handleBackspace:le,handleChar:ue}=Te(700,L),[H,W]=w.useState(null);w.useEffect(()=>{const t=S.current;if(t)return R&&H!==null&&m===void 0&&(t.style.setProperty("width",`${H}px`),t.style.setProperty("box-sizing","border-box")),!R&&m===void 0&&(t.style.removeProperty("width"),t.style.removeProperty("box-sizing")),()=>{m===void 0&&(t.style.removeProperty("width"),t.style.removeProperty("box-sizing"))}},[R,H,m]),w.useEffect(()=>{function t(s){S.current&&(S.current.contains(s.target)||M(!1))}return document.addEventListener("mousedown",t),()=>{document.removeEventListener("mousedown",t)}},[R]),w.useEffect(()=>{if(!R)return;function t(){const s=S.current;s&&W(s.getBoundingClientRect().width)}return window.addEventListener("resize",t),()=>window.removeEventListener("resize",t)},[R]);const{displayOptions:P}=we({options:e,query:q,userTyped:L.current,filterOption:_,searchBy:b,allowCreate:h,multiple:x,filterSelected:k,internalValue:v});w.useEffect(()=>{if(!R){if(C.current){C.current=!1,j(null);return}if(h&&q.trim()){const t=q.trim(),s=e.find(c=>c.value===t||c.label===t);s&&!s.disabled?(r===void 0&&A(s.value),i?.(s.value)):(r===void 0&&A(t),i?.(t))}I(""),j(null)}},[R]),w.useEffect(()=>()=>{V.current&&window.clearTimeout(V.current)},[]);const z=Array.isArray(v)?e.find(t=>t.value===v[0]):e.find(t=>t.value===v),G=Array.isArray(v)?v:[],O=l||a;function oe(){if(!O)if(R)M(!1);else{const t=S.current;if(t){const s=t.getBoundingClientRect().width;W(s)}M(!0),setTimeout(()=>{const s=S.current;s&&s.getBoundingClientRect().width},0)}}function D(t){const s=e.find(g=>g.value===t);if(s&&s.disabled)return;if(x===!0){const g=Array.isArray(v)?[...v]:[],E=g.indexOf(t);E>=0?g.splice(E,1):g.push(t),r===void 0&&A(g),i?.(g),I(""),C.current=!0,k&&M(!1);return}r===void 0&&A(t),i?.(t),y&&(L.current=!1),I(""),C.current=!0,M(!1)}const{onKeyDown:ce}=_e({displayOptions:P,open:R,setOpen:M,handleSelectByValue:D,isDisabled:O,onBackspace:t=>{t.preventDefault(),le({query:q,setQuery:I,options:e,setHighlighted:j})},onChar:t=>{t.preventDefault(),ue({key:t.key,query:q,setQuery:I,options:e,multiple:x,searchable:y,setHighlighted:j})}});w.useEffect(()=>{if(R&&B===null){const t=P,s=t.findIndex(g=>Array.isArray(v)?v.includes(g.value):g.value===v),c=t.findIndex(g=>!g.disabled);j(s>=0?s:c>=0?c:0)}R&&y&&setTimeout(()=>K.current?.focus(),0)},[R]);const de=P;function Q(t,s){s?.stopPropagation();const c=Array.isArray(v)?[...v]:[],g=c.indexOf(t);g>=0&&c.splice(g,1),r===void 0&&A(c),i?.(c)}const me=(t,s)=>{Q(t,s)},pe=t=>{L.current=!0,I(t.target.value),j(0)},fe=t=>{const s=t.target.value;if(!L.current&&!x&&y){let c=s.replace(q,"");c===""&&(c=s),L.current=!0,I(c),j(0);return}L.current=!0,I(s),j(0)},ve=()=>{F(!0),!L.current&&y&&!x&&q&&setTimeout(()=>K.current?.select(),0)},ge=t=>{if(t.stopPropagation(),C.current){C.current=!1,F(!1);return}const s=q.trim();if(h&&s){const c=e.find(g=>g.value===s||g.label===s);c&&!c.disabled?x?D(c.value):(r===void 0&&A(c.value),i?.(c.value)):x?D(s):(r===void 0&&A(s),i?.(s))}I(""),F(!1)},ye=t=>{if(t.stopPropagation(),t.key==="ArrowDown")t.preventDefault(),j(s=>{const c=P,g=s===null?-1:s;for(let E=g+1;E<c.length;E++)if(!c[E].disabled)return E;return s});else if(t.key==="ArrowUp")t.preventDefault(),j(s=>{const c=P,g=s===null?c.length:s;for(let E=g-1;E>=0;E--)if(!c[E].disabled)return E;return s});else if(t.key==="Enter"){t.preventDefault();const s=q.trim();if(h&&s&&!e.find(U=>U.value===s||U.label===s)){D(s),I("");return}const g=P[B??0];g&&!g.disabled&&D(g.value)}else t.key==="Escape"&&M(!1)};return u.jsxs("div",{className:qe(T,O,R,f),ref:S,"aria-disabled":O,style:{...$,...xe(m)},children:[u.jsxs("div",{role:"button",className:"beaver-select__control","aria-haspopup":"listbox","aria-expanded":R,onClick:oe,onKeyDown:ce,tabIndex:O?-1:0,...ae,children:[u.jsx("div",{className:"beaver-select__display",children:y&&R?u.jsx(ee,{multiple:x,query:q,onChangeEvent:x?pe:fe,searchRef:K,onKeyDown:ye,onFocus:ve,onBlur:ge,placeholder:q?"":v&&!Array.isArray(v)?e.find(t=>t.value===v)?.label??String(v):n,selectedValues:G,options:e,removeTag:me,onMouseDown:t=>t.stopPropagation(),onClick:t=>t.stopPropagation()}):Array.isArray(v)?G.length===0?u.jsx("span",{className:"beaver-select__value beaver-select__placeholder",children:n}):u.jsx(te,{selectedValues:G,options:e,onRemove:Q}):u.jsx("span",{className:`beaver-select__value ${v??z?"":"beaver-select__placeholder"}`,children:v?e.find(t=>t.value===v)?.label??v:z?z.label:n})}),u.jsx(ne,{loading:a,loadingIcon:d,icon:p})]}),R&&(()=>{const t=S.current;let s;if(t){const c=t.getBoundingClientRect(),g=c.left+window.scrollX,E=c.bottom+window.scrollY,U=Math.max(window.innerWidth-c.left-16,0);s={position:"absolute",left:`${g}px`,top:`${E}px`,width:"auto",minWidth:H?`${H}px`:void 0,maxWidth:`${U}px`,boxSizing:"border-box",zIndex:"var(--beaver-select-z-index, 5000)"}}return be.createPortal(u.jsx(J,{menuOptions:de,highlighted:B,internalValue:v,onHighlight:c=>j(c),onSelectByValue:c=>D(c),renderHighlightedLabel:c=>re(c,q),noDataLabel:Ne(e.length===0,y,L.current,q),listRef:ie,menuStyle:s}),document.body)})(),x===!0?u.jsx("select",{name:N,multiple:!0,style:{display:"none"},"aria-hidden":!0,children:e.map(t=>u.jsx("option",{value:t.value,selected:Array.isArray(v)?v.includes(t.value):!1,children:t.label},t.value))}):u.jsx("select",{name:N,value:(Array.isArray(v)?v[0]:v)??"",onChange:t=>{D(t.target.value)},style:{display:"none"},"aria-hidden":!0})]})};Ie.__docgenInfo={description:`Select 组件
- 使用场景：在多个选项中进行选择，支持单选和多选
- 支持搜索和过滤选项
- 支持创建新选项
- 支持键盘导航
- 支持自定义样式和图标`,methods:[],displayName:"Select",props:{options:{required:!1,tsType:{name:"Array",elements:[{name:"signature",type:"object",raw:`{
  label: string;
  value: string;
  disabled?: boolean;
}`,signature:{properties:[{key:"label",value:{name:"string",required:!0}},{key:"value",value:{name:"string",required:!0}},{key:"disabled",value:{name:"boolean",required:!1}}]}}],raw:"SelectOption[]"},description:"下拉选项列表",defaultValue:{value:"[]",computed:!1}},placeholder:{required:!1,tsType:{name:"string"},description:"占位符",defaultValue:{value:"'请选择'",computed:!1}},value:{required:!1,tsType:{name:"union",raw:"string | string[]",elements:[{name:"string"},{name:"Array",elements:[{name:"string"}],raw:"string[]"}]},description:"单选时为 string，复选时为 string[]"},defaultValue:{required:!1,tsType:{name:"union",raw:"string | string[]",elements:[{name:"string"},{name:"Array",elements:[{name:"string"}],raw:"string[]"}]},description:"默认值"},onChange:{required:!1,tsType:{name:"signature",type:"function",raw:"(value: string | string[]) => void",signature:{arguments:[{type:{name:"union",raw:"string | string[]",elements:[{name:"string"},{name:"Array",elements:[{name:"string"}],raw:"string[]"}]},name:"value"}],return:{name:"void"}}},description:"事件回调，参数为选中的值"},multiple:{required:!1,tsType:{name:"boolean"},description:"是否支持多选",defaultValue:{value:"false",computed:!1}},searchable:{required:!1,tsType:{name:"boolean"},description:"是否在下拉中显示搜索框",defaultValue:{value:"false",computed:!1}},allowCreate:{required:!1,tsType:{name:"boolean"},description:"是否允许在没有匹配项时创建自定义输入项（默认 false）",defaultValue:{value:"false",computed:!1}},filterOption:{required:!1,tsType:{name:"signature",type:"function",raw:"(input: string, option: SelectOption) => boolean",signature:{arguments:[{type:{name:"string"},name:"input"},{type:{name:"signature",type:"object",raw:`{
  label: string;
  value: string;
  disabled?: boolean;
}`,signature:{properties:[{key:"label",value:{name:"string",required:!0}},{key:"value",value:{name:"string",required:!0}},{key:"disabled",value:{name:"boolean",required:!1}}]}},name:"option"}],return:{name:"boolean"}}},description:"定制过滤函数：如果提供，将优先使用"},searchBy:{required:!1,tsType:{name:"union",raw:"'label' | 'value' | 'both'",elements:[{name:"literal",value:"'label'"},{name:"literal",value:"'value'"},{name:"literal",value:"'both'"}]},description:"搜索策略：'label' 只按 label 搜索，'value' 只按 value，'both' 按 label 与 value 搜索但优先 label 匹配",defaultValue:{value:"'both'",computed:!1}},filterSelected:{required:!1,tsType:{name:"boolean"},description:"仅在 `multiple` 为 true 时生效：在下拉中隐藏已选项，并在每次多选后关闭下拉。",defaultValue:{value:"false",computed:!1}},disabled:{required:!1,tsType:{name:"boolean"},description:"是否禁用",defaultValue:{value:"false",computed:!1}},loading:{required:!1,tsType:{name:"boolean"},description:"是否加载中",defaultValue:{value:"false",computed:!1}},icon:{required:!1,tsType:{name:"ReactReactNode",raw:"React.ReactNode"},description:"自定义箭头/后缀图标（传入 ReactNode）"},loadingIcon:{required:!1,tsType:{name:"ReactReactNode",raw:"React.ReactNode"},description:"自定义 loading 图标（传入 ReactNode），优先于默认 spinner"},width:{required:!1,tsType:{name:"union",raw:"number | string",elements:[{name:"number"},{name:"string"}]},description:"直接设置组件宽度，支持 number(像素) 或 字符串(如 '50%','200px')"},size:{required:!1,tsType:{name:"union",raw:"'small' | 'medium' | 'large'",elements:[{name:"literal",value:"'small'"},{name:"literal",value:"'medium'"},{name:"literal",value:"'large'"}]},description:"组件尺寸",defaultValue:{value:"'medium'",computed:!1}}}};export{Ie as S};
